import{uuid}from"simple-uuidv4";var script={name:"log",props:{className:String,loadPoint:Array,unloadPoint:Array,loadRule:Function,unloadRule:Function,amap:Object}};function normalizeComponent(e,n,t,i,a,r,o,c,s,l){"boolean"!=typeof o&&(s=c,c=o,o=!1);var d,u,p="function"==typeof t?t.options:t;return e&&e.render&&(p.render=e.render,p.staticRenderFns=e.staticRenderFns,p._compiled=!0,a&&(p.functional=!0)),i&&(p._scopeId=i),r?p._ssrRegister=d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,s(e)),e&&e._registeredComponents&&e._registeredComponents.add(r)}:n&&(d=o?function(e){n.call(this,l(e,this.$root.$options.shadowRoot))}:function(e){n.call(this,c(e))}),d&&(p.functional?(u=p.render,p.render=function(e,n){return d.call(n),u(e,n)}):(o=p.beforeCreate,p.beforeCreate=o?[].concat(o,d):[d])),t}var HEAD,isOldIE="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function createInjector(e){return function(e,n){return addStyle(e,n)}}var styles={};function addStyle(e,n){var t=isOldIE?n.media||"default":e,i=styles[t]||(styles[t]={ids:new Set,styles:[]});i.ids.has(e)||(i.ids.add(e),t=n.source,n.map&&(t+="\n/*# sourceURL="+n.map.sources[0]+" */",t+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",n.media&&i.element.setAttribute("media",n.media),(HEAD=void 0===HEAD?document.head||document.getElementsByTagName("head")[0]:HEAD).appendChild(i.element)),"styleSheet"in i.element?(i.styles.push(t),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n")):(e=i.ids.size-1,n=document.createTextNode(t),(t=i.element.childNodes)[e]&&i.element.removeChild(t[e]),t.length?i.element.insertBefore(n,t[e]):i.element.appendChild(n)))}var __vue_script__=script,__vue_render__=function(){var e=this,n=e.$createElement,n=e._self._c||n;return n("div",{staticClass:"log"},[n("div",[e._v("className:"+e._s(e.className))]),e._v(" "),n("div",[e._v("logPoint:"+e._s(e.logPoint))]),e._v(" "),n("div",[e._v("unloadPoint:"+e._s(e.unloadPoint))]),e._v(" "),n("div",[e._v("loadRule:"+e._s(e.loadRule))]),e._v(" "),n("div",[e._v("unloadRule:"+e._s(e.unloadRule))]),e._v(" "),n("div",[e._v("amap:"+e._s(e.amap))])])},__vue_staticRenderFns__=[];__vue_render__._withStripped=!0;var __vue_inject_styles__=function(e){e&&e("data-v-627e1c07_0",{source:"\ndiv.log[data-v-627e1c07] {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n",map:{version:3,sources:["/media/liuhanru/mywork/apps/dayi/admin-widget/src/waybill/components/log.vue"],names:[],mappings:";AA0BA;EACA,aAAA;EACA,sBAAA;EACA,uBAAA;AACA",file:"log.vue",sourcesContent:["<template>\n<div class=\"log\">\n  <div>className:{{className}}</div>\n  <div>logPoint:{{logPoint}}</div>\n  <div>unloadPoint:{{unloadPoint}}</div>\n  <div>loadRule:{{loadRule}}</div>\n  <div>unloadRule:{{unloadRule}}</div>\n  <div>amap:{{amap}}</div>\n</div>\n</template>\n\n<script>\nexport default {\n  name:'log',\n  props:{\n    className:String,\n    loadPoint:Array,\n    unloadPoint:Array,\n    loadRule:Function,\n    unloadRule:Function,\n    amap:Object,\n  },\n}\n<\/script>\n\n<style scoped>\ndiv.log {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n}\n</style>"]},media:void 0})},__vue_scope_id__="data-v-627e1c07",__vue_module_identifier__=void 0,__vue_is_functional_template__=!1,__vue_component__=normalizeComponent({render:__vue_render__,staticRenderFns:__vue_staticRenderFns__},__vue_inject_styles__,__vue_script__,__vue_scope_id__,__vue_is_functional_template__,__vue_module_identifier__,!1,createInjector,void 0,void 0),img="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='56px' height='56px' viewBox='0 0 56 56' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3ctitle%3e%e7%bc%96%e7%bb%84 10%3c/title%3e %3cg id='2020.04.03--%e5%9c%b0%e5%9b%be%e4%bc%98%e5%8c%96' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='A4-1--2-%e8%bf%90%e5%8d%95%e8%bd%a8%e8%bf%b9-%e5%ae%9e%e6%97%b6%e8%bd%a8%e8%bf%b9' transform='translate(-747.000000%2c -654.000000)'%3e %3cg id='%e7%bc%96%e7%bb%84-10' transform='translate(747.000000%2c 654.000000)'%3e %3cpath d='M3.02083333%2c25.0568182 C1.36397908%2c25.0568182 0.0208333333%2c23.7136724 0.0208333333%2c22.0568182 L0.0208333333%2c3 C0.0208333333%2c1.34314575 1.36397908%2c-1.53269159e-12 3.02083333%2c-1.53299595e-12 L52.1458333%2c-1.53299595e-12 C53.8026876%2c-1.52888557e-12 55.1458333%2c1.34314575 55.1458333%2c3 L55.1458333%2c22.0568182 C55.1458333%2c23.7136724 53.8026876%2c25.0568182 52.1458333%2c25.0568182 L32.5265152%2c25.0568182 L27.5833333%2c30 L22.6401515%2c25.0568182 L3.02083333%2c25.0568182 Z' id='%e5%bd%a2%e7%8a%b6%e7%bb%93%e5%90%88' fill='%2337A800'%3e%3c/path%3e %3ctext id='%e8%a3%85%e8%b4%a7%e5%9c%b0' font-family='PingFang-SC-Heavy%2c PingFang SC' font-size='14' font-weight='600' line-spacing='13' letter-spacing='-1.07692308' fill='white'%3e %3ctspan x='8.08333333' y='16.5284091'%3e%e8%a3%85%e8%b4%a7%e5%9c%b0%3c/tspan%3e %3c/text%3e %3c/g%3e %3c/g%3e %3c/g%3e %3cg id='2020.04.03--%e5%9c%b0%e5%9b%be%e4%bc%98%e5%8c%96' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='A4-1--2-%e8%bf%90%e5%8d%95%e8%bd%a8%e8%bf%b9-%e5%ae%9e%e6%97%b6%e8%bd%a8%e8%bf%b9' transform='translate(-764.000000%2c -689.000000)' fill-rule='nonzero'%3e %3cg id='%e7%bc%96%e7%bb%84-15' transform='translate(764.000000%2c 689.000000)'%3e %3ccircle id='%e6%a4%ad%e5%9c%86%e5%bd%a2' fill='%23BBE8A7' cx='28' cy='45' r='11'%3e%3c/circle%3e %3ccircle id='%e6%a4%ad%e5%9c%86%e5%bd%a2' fill='%2337A800' cx='28' cy='45' r='6'%3e%3c/circle%3e %3c/g%3e %3c/g%3e %3c/g%3e%3c/svg%3e",img$1="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='56px' height='56px' viewBox='0 0 56 56' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3ctitle%3e%e7%bc%96%e7%bb%84 10%3c/title%3e %3cg id='2020.04.03--%e5%9c%b0%e5%9b%be%e4%bc%98%e5%8c%96' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='A4-1--2-%e8%bf%90%e5%8d%95%e8%bd%a8%e8%bf%b9-%e5%ae%9e%e6%97%b6%e8%bd%a8%e8%bf%b9' transform='translate(-331.000000%2c -1026.000000)'%3e %3cg id='%e7%bc%96%e7%bb%84-10' transform='translate(331.476117%2c 1026.748301)'%3e %3cpath d='M3.02083333%2c25.0568182 C1.36397908%2c25.0568182 0.0208333333%2c23.7136724 0.0208333333%2c22.0568182 L0.0208333333%2c3 C0.0208333333%2c1.34314575 1.36397908%2c-1.53269159e-12 3.02083333%2c-1.53299595e-12 L52.1458333%2c-1.53299595e-12 C53.8026876%2c-1.53330031e-12 55.1458333%2c1.34314575 55.1458333%2c3 L55.1458333%2c22.0568182 C55.1458333%2c23.7136724 53.8026876%2c25.0568182 52.1458333%2c25.0568182 L32.5265152%2c25.0568182 L27.5833333%2c30 L22.6401515%2c25.0568182 L3.02083333%2c25.0568182 Z' id='%e5%bd%a2%e7%8a%b6%e7%bb%93%e5%90%88' fill='%23E02020'%3e%3c/path%3e %3ctext id='%e5%8d%b8%e8%b4%a7%e5%9c%b0' font-family='PingFang-SC-Heavy%2c PingFang SC' font-size='14' font-weight='600' line-spacing='13' letter-spacing='-1.07692308' fill='white'%3e %3ctspan x='8.08333333' y='16.5284091'%3e%e5%8d%b8%e8%b4%a7%e5%9c%b0%3c/tspan%3e %3c/text%3e %3c/g%3e %3c/g%3e %3c/g%3e %3cg id='2020.04.03--%e5%9c%b0%e5%9b%be%e4%bc%98%e5%8c%96' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='A4-1--2-%e8%bf%90%e5%8d%95%e8%bd%a8%e8%bf%b9-%e5%ae%9e%e6%97%b6%e8%bd%a8%e8%bf%b9' transform='translate(-348.000000%2c -1060.000000)' fill-rule='nonzero'%3e %3cg id='%e7%bc%96%e7%bb%84-40' transform='translate(348.000000%2c 1060.000000)'%3e %3ccircle id='22' fill='%23FFA6A6' cx='28' cy='45' r='11'%3e%3c/circle%3e %3ccircle id='%e6%a4%ad%e5%9c%86%e5%bd%a2%e5%a4%87%e4%bb%bd-12' fill='%23E02020' cx='28' cy='45' r='6'%3e%3c/circle%3e %3c/g%3e %3c/g%3e %3c/g%3e%3c/svg%3e",img$2="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='41px' height='62px' viewBox='0 0 41 62' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3ctitle%3e%e7%bc%96%e7%bb%84 7%3c/title%3e %3cg id='2020.04.03--%e5%9c%b0%e5%9b%be%e4%bc%98%e5%8c%96' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='A4-1--2-%e8%bf%90%e5%8d%95%e8%bd%a8%e8%bf%b9-%e5%ae%9e%e6%97%b6%e8%bd%a8%e8%bf%b9' transform='translate(-810.000000%2c -646.000000)'%3e %3cg id='%e7%bc%96%e7%bb%84-7' transform='translate(812.866894%2c 648.000000)'%3e %3cellipse id='%e6%a4%ad%e5%9c%86%e5%bd%a2%e5%a4%87%e4%bb%bd-2' fill-opacity='0.2' fill='black' cx='18.3012368' cy='51.3314119' rx='10.5981615' ry='8.3345881'%3e%3c/ellipse%3e %3cpath d='M16.9593067%2c-0.976116808 C22.3919129%2c-1.24439367 27.3222956%2c0.761385037 30.9029773%2c4.17155805 C34.5086806%2c7.60556122 36.746576%2c12.465442 36.746576%2c17.8683295 C36.746576%2c24.0566555 33.7908519%2c29.440619 29.2157607%2c32.9392182 C24.4902463%2c36.4531751 21.450293%2c41.7668045 21.450293%2c47.6960814 L21.450293%2c47.6960814 L21.450293%2c48.4608955 C21.450293%2c49.4369752 21.0520644%2c50.3249572 20.4085193%2c50.9685023 C19.7649742%2c51.6120474 18.8769921%2c52.010276 17.9009125%2c52.010276 C16.9248329%2c52.010276 16.0368509%2c51.6120474 15.3933058%2c50.9685023 C14.7497607%2c50.3249572 14.351532%2c49.4369752 14.351532%2c48.4608955 L14.351532%2c48.4608955 L14.351532%2c47.6960814 C14.351532%2c42.0312519 11.710791%2c36.4786611 7.00671149%2c33.2219906 C1.75505514%2c29.5862285 -1.48054408%2c23.393076 -0.941097633%2c16.3807691 C-0.537957782%2c11.677471 1.60858985%2c7.44288599 4.81514677%2c4.33276687 C8.03230539%2c1.21236491 12.3142867%2c-0.774176798 16.9593067%2c-0.976116808 Z' id='%e5%bd%a2%e7%8a%b6' stroke='white' stroke-width='2' fill='%2300A19C' fill-rule='nonzero'%3e%3c/path%3e %3ctext id='%e6%8f%90%e8%b4%a7' font-family='PingFang-SC-Heavy%2c PingFang SC' font-size='14' font-weight='600' line-spacing='14' letter-spacing='-0.7' fill='white'%3e %3ctspan x='3.565288' y='23.630223'%3e%e6%8f%90%e8%b4%a7%3c/tspan%3e %3c/text%3e %3c/g%3e %3c/g%3e %3c/g%3e%3c/svg%3e",img$3="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='41px' height='62px' viewBox='0 0 41 62' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3ctitle%3e%e7%bc%96%e7%bb%84 7%3c/title%3e %3cg id='2020.04.03--%e5%9c%b0%e5%9b%be%e4%bc%98%e5%8c%96' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='A4-1--2-%e8%bf%90%e5%8d%95%e8%bd%a8%e8%bf%b9-%e5%ae%9e%e6%97%b6%e8%bd%a8%e8%bf%b9' transform='translate(-385.000000%2c -1026.000000)'%3e %3cg id='%e7%bc%96%e7%bb%84-7' transform='translate(387.476117%2c 1028.000000)'%3e %3cellipse id='%e6%a4%ad%e5%9c%86%e5%bd%a2%e5%a4%87%e4%bb%bd-2' fill-opacity='0.2' fill='black' cx='18.3012368' cy='51.3314119' rx='10.5981615' ry='8.3345881'%3e%3c/ellipse%3e %3cpath d='M16.9593067%2c-0.976116808 C22.3919129%2c-1.24439367 27.3222956%2c0.761385037 30.9029773%2c4.17155805 C34.5086806%2c7.60556122 36.746576%2c12.465442 36.746576%2c17.8683295 C36.746576%2c24.0566555 33.7908519%2c29.440619 29.2157607%2c32.9392182 C24.4902463%2c36.4531751 21.450293%2c41.7668045 21.450293%2c47.6960814 L21.450293%2c47.6960814 L21.450293%2c48.4608955 C21.450293%2c49.4369752 21.0520644%2c50.3249572 20.4085193%2c50.9685023 C19.7649742%2c51.6120474 18.8769921%2c52.010276 17.9009125%2c52.010276 C16.9248329%2c52.010276 16.0368509%2c51.6120474 15.3933058%2c50.9685023 C14.7497607%2c50.3249572 14.351532%2c49.4369752 14.351532%2c48.4608955 L14.351532%2c48.4608955 L14.351532%2c47.6960814 C14.351532%2c42.0312519 11.710791%2c36.4786611 7.00671149%2c33.2219906 C1.75505514%2c29.5862285 -1.48054408%2c23.393076 -0.941097633%2c16.3807691 C-0.537957782%2c11.677471 1.60858985%2c7.44288599 4.81514677%2c4.33276687 C8.03230539%2c1.21236491 12.3142867%2c-0.774176798 16.9593067%2c-0.976116808 Z' id='%e5%bd%a2%e7%8a%b6' stroke='white' stroke-width='2' fill='%23008EDD' fill-rule='nonzero'%3e%3c/path%3e %3ctext id='%e5%8d%b8%e8%b4%a7' font-family='PingFang-SC-Heavy%2c PingFang SC' font-size='14' font-weight='600' line-spacing='14' letter-spacing='-0.7' fill='white'%3e %3ctspan x='3.565288' y='23.630223'%3e%e5%8d%b8%e8%b4%a7%3c/tspan%3e %3c/text%3e %3c/g%3e %3c/g%3e %3c/g%3e%3c/svg%3e",tian_an_men=[116.397423,39.909117],prepareMap=function(n){return n.amapResolve?(n.containerResolve||(n.containerResolve=n.amapResolve.then(function(e){var t=new e.Map(n.amapId,{center:tian_an_men,zoom:11});return new Promise(function(e,n){t.on("complete",function(){e(t)})})})),Promise.resolve("ok")):Promise.reject("null amap")},callOnInitLifeCircle=function(e){return e.amap?(e.amapResolve||(e.amapResolve=Promise.resolve(e.amap)),e.amapResolve):Promise.reject("amap is not prepared")},glossary={pathType:{union:0,driver:1,vehicle:2,full:3},pointType:{app:1,zjxl:2,selfGPS:3,mmsi:4,handle5:5,handle6:6},lorryType:{lorry:"lorry",boat:"boat"},deviceMapping:{1:"APP",2:"辅助设备",3:"辅助设备",4:"辅助设备",5:"APP",6:"App"}},keyOfPointHandler={defaultKeyOfPoint:function(e,n,t){return void 0===t&&(t=""),[n=void 0===n?"":n,(+e[0]).toFixed(4),(+e[1]).toFixed(4),t].filter(function(e){return!!e}).join("/")}},setKeyOfPointGenerator=function(e){void 0===e&&(e=keyOfPointHandler.defaultKeyOfPoint),keyOfPointHandler.handler=e};setKeyOfPointGenerator();var obj,obj$1,obj$2,getKeyOfPoint=function(e,n,t){return keyOfPointHandler.handler(e,n,t)},map_base=Object.freeze({__proto__:null,prepareMap:prepareMap,callOnInitLifeCircle:callOnInitLifeCircle,tian_an_men:tian_an_men,glossary:glossary,getKeyOfPoint:getKeyOfPoint,setKeyOfPointGenerator:setKeyOfPointGenerator}),tian_an_men$1=tian_an_men,pointRule=function(e,n,t){return(e=void 0===e?0:e)<=1e4?[t,Object.assign({type:"circle",radius:3e3},n)]:e<=3e4?[t,Object.assign({type:"circle",radius:4e3},n)]:e<1e5?[t,Object.assign({type:"district"},n,{fillOpacity:.4}),Object.assign({type:"circle",radius:5e3},n)]:[t,Object.assign({type:"district"},n,{fillOpacity:.4}),Object.assign({type:"circle",radius:1e4},n)]},defaultLoadRule=function(e){return pointRule(e=void 0===e?0:e,{fillColor:"#37A80040",strokeColor:"#37A80080",fillOpacity:.5,strokeOpacity:.5},{image:img,size:[56,56],offset:[-28,-45],type:"marker"})},defaultUnloadRule=function(e){return pointRule(e=void 0===e?0:e,{fillColor:"#E0202040",strokeColor:"#E0202080",fillOpacity:.5,strokeOpacity:.5},{image:img$1,size:[56,56],offset:[-28,-45],type:"marker"})},codeMap={district:"adcode"},districtMap={},getKeyOfPoint$1=getKeyOfPoint,drawDistrict=function(r,o,e,c){void 0===c&&(c={});var s=(e=void 0===e?[]:e).slice(0,2),l=getKeyOfPoint$1(s);return new Promise(function(i,a){return(new r.Geocoder).getAddress(new(Function.prototype.bind.apply(r.LngLat,[null].concat(s))),function(e,n){if(!("complete"==e&&"OK"==n.info))return a("unknown district,"+s);var t=n.regeocode.addressComponent[codeMap[c.type]];return new r.DistrictSearch({level:c.type,extensions:"all",subdistrict:0}).search(t,function(e,n){if("complete"!=e)return Promise.reject("unknown district,"+t);e=n.districtList[0];if(!e)return Promise.reject("unknown district,"+n);e=e.boundaries;districtMap[l]&&o.remove(districtMap[l]);e=Object.assign({},c,{type:void 0,map:o,path:e}),e=new r.Polygon(e);return districtMap[l]=e,i(e)})})})},circleMap={},drawCircle=function(e,n,t,i){void 0===i&&(i={});var a=t.slice(0,2),t=getKeyOfPoint$1(a);circleMap[t]&&n.remove(circleMap[t]);a=Object.assign({},i,{type:void 0,center:a.slice()}),a=new e.Circle(a);return circleMap[t]=a,n.add(a),Promise.resolve(a)},markerMap={},drawMarker=function(r,o,e,c,s){void 0===c&&(c={}),void 0===s&&(s="");e.reduce(function(e,n,t,i){return t%2==0&&(t=[n,i[t+1]],e.push(t)),e},[]).map(function(e){var n=s+"/"+getKeyOfPoint$1(e);markerMap[n]&&o.remove(markerMap[n]);var t=c.size,i=t[0],a=t[1],t=new r.Icon({image:c.image,size:new r.Size(i,a),imageSize:new r.Size(i,a)}),i=c.offset,a=i[0],i=i[1],t=new r.Marker({position:e.slice(),offset:new r.Pixel(a,i),icon:t,autoRotation:!0,angle:0,extData:n});return markerMap[n]=t,o.add(t),t})},drawPoint=function(n,t,i,e,a){a=e(a).map(function(e){switch(e.type){case"province":case"city":case"district":return drawDistrict(n,t,i,e);case"circle":return drawCircle(n,t,i,e);case"marker":return drawMarker(n,t,i,e);default:return[i,i]}})||[[i,i]];return Promise.all(a)},zoomMap=function(e,n,t){n.setFitView(null,!0,t=void 0===t?[20,20,20,20]:t,18)},renderTheRoute=function(a){return prepareMap(a).then(function(e){return Promise.all([a.amapResolve,a.containerResolve])}).then(function(e){var n=e[0],t=e[1],i=(a.loadPoint||a.unloadPoint||tian_an_men$1).slice(),e=(a.unloadPoint||a.loadPoint||tian_an_men$1).slice(),i=a.trackInfo&&a.trackInfo.realDistance||n.GeometryUtil.distance(i,e),e=a.loadPoint&&drawPoint(n,t,a.loadPoint.slice(),a.loadRule||defaultLoadRule,i)||[void 0,void 0],i=a.unloadPoint&&drawPoint(n,t,a.unloadPoint.slice(),a.unloadRule||defaultUnloadRule,i)||[void 0,void 0];return Promise.all([n,t,e,i])}).then(function(e){var n=e[0],e=e[1];return zoomMap(n,e,a.avoid)})},renderTheAction=function(s,l,d,u){return void 0===l&&(l=[]),void 0===d&&(d=[]),void 0===u&&(u=[]),prepareMap(s).then(function(e){return Promise.all([s.amapResolve,s.containerResolve])}).then(function(e){function n(e){return!!e.lng&&!!e.lat}var a=e[0],r=e[1],o={},c=0,t=function(i){return function(e){var n=[e.lng,e.lat],t=getKeyOfPoint$1(n);return console.log("has duplicate",t,e),o[t]&&(c+=10),o[t]=!0,drawMarker(a,r,n,Object.assign({size:[41,62],offset:[-21+c,-61]},i(e)),e.$type)}},i=t(function(){return{image:img$2}}),e=l.filter(n).map(i).flat(),i=t(function(){return{image:img$3}}),i=d.filter(n).map(i).flat(),t=t(function(e){return s.otherActionType[e.$type](e)}),t=u.filter(n).map(t).flat();return Promise.all(e.concat(i).concat(t)).catch(function(e){return console.log("err",e),Promise.reject(e)})})},findDriverActionList=function(e,n){return void 0===n&&(n=-1),(e=void 0===e?[]:e).filter(function(e){return e.operateTypeLm==n||n[e.operateTypeLm]}).map(function(e){return Object.assign({},e,{lng:e.operateLon,lat:e.operateLat,$type:e.operateTypeLm})})},load_unload=Object.freeze({__proto__:null,renderTheRoute:renderTheRoute,renderTheAction:renderTheAction,findDriverActionList:findDriverActionList}),img$4="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%234b8ee6' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$5="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%234b8ee6' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$6="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%23a0a000' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$7="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%23a0a000' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$8="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%2300b564' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$9="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%2300b564' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$a="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%23eb1717' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$b="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%23eb1717' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$c="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%23f5a500' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$d="data:image/svg+xml,%3c%3fxml version='1.0' standalone='no'%3f%3e%3csvg width='200' height='200' version='1.1' xmlns='http://www.w3.org/2000/svg'%3e %3ccircle cx='100' cy='100' r='50' stroke='%23f5a500' fill='transparent' stroke-width='100'/%3e %3ccircle cx='100' cy='100' r='75' stroke='white' fill='transparent' stroke-width='50'/%3e%3c/svg%3e",img$e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAASCAYAAAAg9DzcAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAALKADAAQAAAABAAAAEgAAAADif+FEAAAE6ElEQVRIDb1Vz2slRRCunh957yUxCTFLjEjAg3jzsoIgePKweFjXmyCLoH+AB69ePQreBI+KoIgX3YPnPbjocVFclMXFNVmIkt3gy3sz82a62++r7p5MkmVBEAtmqrq6fnxVXT1jJJLfe+t9WXvmPfFQGCOBp92zHPtD0mXUeQTo/c/YDX16mTb56+axd7/sVRAuv7h95dqNg6+HOsoa0d+69IaUKx/IhYs7asCEJIJX4loriR4ny5P9IOk7up/2j/vD2Mluvv+9zO7VKcJsZlen83ZzfWf7o8lk/LlslQ+M+bDivvE3Lr4mTr6Q7d0pAG8lp1N8mIQ1DvCrXSpM7WJhwwAJmNoN/ePG9PcDOd7fDu1LxiKffHXQvvn2c7kRnyFpI7l/urh7Z/bp7lPLI5FuIXaBNMOAMWvCkICpOgV+iP0QrHfiFk2Iy3eWiymXBhbwd86KbQe6IB49qF1XzbuyMBNoRhi15eLwb1fscu5sNxZ33im081ysM4oEPqrZ6VikbyrJRsxHCna+ngI0epROzlknbSNd04l3XvJRKRn6Kt5bu6jbUnIEQECXjQvJMhfi+FJ852EUs5OlliY5bg2Sq5jQqRl9eIJgrQXHmidnMvGLCqzULvvmGKDHATRwdfNaFtVCmN1UtSxvTMQ64J1X7dgUIU2eTwonmQ1W0HkPD4/SSQlskonA4SEnDffjntZ6InuHXhSFuAaAcer0MROA5ImqO+LRh51sF9J1OGGs0TXxLQp0zqGITpboS/diXHhhh9ERdmW0UYONNJgeF5MzMjmZBqegS32lY034kw24seyFkWxCP84yPgTjFbgDTD0XM14OMav7Cw+wtu0QknBBXU4fdLjuZAUd1rHNAdhknQIucBEyh9sRj5Nu6ZuaZAVKsD06Bg1JmSTVoRw2GQReOM6wD5dNu+6tZOi8UvB3HmNjO8xw0GI6c45E11S1FUyxYskwwz7LA+AMARxGwvDYQeyUdmsAqAce9zU87FgYSVmUkz/1/AIYAM4DSN806C4vInOxOuML0wXAcM9RaOYAxVrXzGsnHewYNvOYYYMZ5kjk7LDhDIcgyiEraHKouUWijguuVeS+JuZuoOhvRrgSGA20LODLMoDFHA/9sSilk80VL4vWy2QEPCjSudYuqhZfkAg4x0hggBGJgLXtbEUIlngqIOLQfdVBcQosC4jAE6cPZYDsC6dT8td9xgkAgUBKvnhBGcqLraoGgHkyULSGl65oNRgBG99q17B9QkQFGiYJGo2RxJ4PwWqw2ICH+WvFOnKG3+FQFCJFlxz3q5njw9yxABYu6LA3ASRHop3+gdtw1Hv0KJIQI6Wl8liQyujUIynZIrmiorGR2eHh6p/7xS95hvahu/iG4C9s5fKztlxbLzel7WYwDH861Bc63B5fl/avVxiip4Qv5ek3opDykiudUfTzHwOk7vfdht67w59+uP14NV2TEjOwZCweJ78dLATfCXn1CcS8j0ntuqmU9hpnGIBlJrd+fCmccUJJBEmOCQOq/+7NC3/hydUXnt8hIFy0k2f3qJH1ES8bLyv+wNZeNVdu/1xMZ352Z6+e4D99/jwHePGPOg/0TEMfVXBo6mmHydbm3e++vbd3LjCN+Zckt14218fXX37n5je0M1cvbe0sb2ygxP+XTJnZjz/79ea/zfoPmrxX/fCo28YAAAAASUVORK5CYII=",img$f="data:image/png;base64,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",getTrackParts=function(e){var t=0;return(e=void 0===e?[]:e).reduce(function(e,n){return n.trackDistance&&14e3<n.trackDistance&&(t+=1),e[t]=e[t]||[],e[t].push(n),e},[[]])},confirmAmap=function(n){return prepareMap(n).then(function(e){return Promise.all([n.amapResolve,n.containerResolve])})},globaTrackMap=new WeakMap,removeTrackLine=function(t,i){return void 0===i&&(i="lines"),confirmAmap(t).then(function(e){e[0];var n=e[1],e=globaTrackMap.get(t.amapResolve)||{};e[i]=e[i]||[],e[i].forEach(function(e){return n.remove(e)}),e[i]=[]})},drawTrackLine=function(a,r,o,c){return void 0===o&&(o="#2288ff"),void 0===c&&(c="lines"),confirmAmap(a).then(function(e){var t=e[0],i=e[1],n=globaTrackMap.get(a.amapResolve)||{};globaTrackMap.set(a.amapResolve,n),n[c]=n[c]||[],n[c].forEach(function(e){return i.remove(e)});e=r.map(function(e,n){e=e.slice().map(function(e){return[e.lng,e.lat]});return new t.Polyline({map:i,bubble:!0,path:e,showDir:!0,geodesic:!1,lineJoin:"round",lineCap:"round",strokeColor:o,strokeWeight:6})});return n[c]=e})},globalMarkerMap=new WeakMap,pointType=glossary.pointType,loadPointIconSetting={pass:((obj={})[pointType.app]=img$8,obj[pointType.zjxl]=img$a,obj[pointType.selfGPS]=img$c,obj[pointType.mmsi]=img$c,obj[pointType.handle5]=img$4,obj[pointType.handle6]=img$6,obj),passOver:((obj$1={})[pointType.app]=img$9,obj$1[pointType.zjxl]=img$b,obj$1[pointType.selfGPS]=img$d,obj$1[pointType.mmsi]=img$d,obj$1[pointType.handle5]=img$5,obj$1[pointType.handle6]=img$7,obj$1),lorry:((obj$2={})[glossary.lorryType.lorry]={image:img$e,size:[32,16],imageSize:[32,16],offset:[-5,-8]},obj$2[glossary.lorryType.boat]={image:img$f,size:[36,12],imageSize:[36,12],offset:[-9,-4]},obj$2)},drawPassPointMarker=function(e,n,t,i,a,r){void 0===e&&(e={});var o=new t.Icon({image:loadPointIconSetting.pass[n.origin],size:new t.Size(12,12),imageSize:new t.Size(12,12)}),c=new t.Icon({image:loadPointIconSetting.passOver[n.origin],size:new t.Size(20,20),imageSize:new t.Size(20,20)}),s=[n.lng,n.lat],l=new t.Marker({position:[n.lng,n.lat],icon:o,bubble:!0,offset:new t.Pixel(-6,-6)});return(e[n.key||getKeyOfPoint(s)]=l).trackInfo=n,l.on("mouseover",function(e){l.setIcon(c),l.setOffset(new t.Pixel(-10,-10)),a.focusedPoint=n,newInfoWindow(a,n).then(function(e){var n=e[0],e=(e[1],e[2]);n.getIsOpen()?n.setPosition(s):n.open(e,s)})}),l.on("mouseout",function(e){l.setIcon(o),l.setOffset(new t.Pixel(-6,-6)),a.focusedPoint=null,newInfoWindow(a,n).then(function(e){var n=e[0];e[1],e[2];n.getIsOpen()&&n.close()})}),l.on("click",function(e){a.$emit("clickPoint",n)}),l},drawTrackPassPoint=function(d,n,t){return void 0===t&&(t="lines"),confirmAmap(d).then(function(e){var o=e[0],c=e[1],e=globalMarkerMap.get(d.amapResolve)||{};globalMarkerMap.set(d.amapResolve,e);var s=c.getResolution(),l=e[t]=e[t]||{};return function(){clearPartMakerList(l,c);c.getBounds();return n.map(function(e,n){var e=(e=void 0===e?[]:e).filter(function(e){return e.lng&&e.lat}),t=e.length-1,i=1;switch(d.pointDensity){case 0:case"nopass":i=1/0;break;case 1:case"everypass":i=0;break;default:var a=1<parseFloat(d.pointDensity)?5*d.pointDensity:72,i=s*a}var r=0;return e.filter(function(e,n){n=0==n||n==t||e.isDangerous;r+=e.trackDistance||0;e=i<=r;return e&&(r=0),n||e}).map(function(e){e=drawPassPointMarker(l,e,o,c,d);return c.add(e),e})})}()})},clearPartMakerList=function(t,i){return void 0===t&&(t={}),Object.entries(t).filter(function(e){e[0];return!!e[1]}).forEach(function(e){var n=e[0],e=e[1];i.remove(e),delete t[n]})},removePassPoint=function(t,i){return void 0===i&&(i="lines"),confirmAmap(t).then(function(e){e[0];var n=e[1],e=globalMarkerMap.get(t.amapResolve)||{};globalMarkerMap.set(t.amapResolve,e);e=e[i]=e[i]||{};return clearPartMakerList(e,n)})},getDistance=function(e,n,t){return n?t.GeometryUtil.distance([e.lng,e.lat],[n.lng,n.lat]):0},validPointMap=new WeakMap,getValidPathArray=function(n,a,r){void 0===a&&(a=[]),void 0===r&&(r=1);var o={};return confirmAmap(n).then(function(e){var i=e[0],t=(e[1],validPointMap.get(n.amapResolve)||{});return validPointMap.set(n.amapResolve,t),a.filter(function(e){var n=e.key||getKeyOfPoint([e.lng,e.lat]);return!o[n]&&(t[e.uid]=e,o[e.key]=e,!0)}).sort(function(e,n){return(e.timeSec-n.timeSec)*r}).map(function(e,n,t){return Object.assign({},e,{trackDistance:getDistance(e,t[n-1],i)})})})},shinningMap=new WeakMap,clearShinning=function(e){e&&shinningMap.has(e)&&(e=shinningMap.get(e),clearInterval(e))},shinningTheMarker=function(e){var n;e&&(clearShinning(e),n=setInterval(function(){Date.now()%3e3<2500?e.show():e.hide()},100),shinningMap.set(e,n))},lorryMap=new WeakMap,prepareLorryMarker=function(r,o,c,s,l){return void 0===c&&(c="lorry"),0==(o=void 0===o?[]:o).length?Promise.reject("缺少途径轨迹坐标"):confirmAmap(r).then(function(e){var n=e[0],t=e[1],i=lorryMap.get(r.amapResolve),a=o[0],e=[a.lng,a.lat];return lorryMap.has(r.amapResolve)||(a=loadPointIconSetting.lorry[c],(i=new n.Marker({position:e,icon:new n.Icon({image:a.image,size:new(Function.prototype.bind.apply(n.Size,[n.Size].concat(a.size))),imageSize:new(Function.prototype.bind.apply(n.Size,[n.Size].concat(a.size)))}),bubble:!0,autoRotation:!0,angle:0,offset:new(Function.prototype.bind.apply(n.Pixel,[n.Pixel].concat(a.offset))),extData:c})).on("moving",function(e){s&&s.apply&&s.call(r,e)}),i.on("movealong",function(e){r.isRunning&&shinningTheMarker(i)}),i.on("moveend",function(e){var n=validPointMap.get(r.amapResolve)||{};validPointMap.set(r.amapResolve,n);var t=e.target.getPosition(),n=n[getKeyOfPoint([t.lng,t.lat])];r.selectedPoint||r.focusedPoint||(newInfoWindow(r,n).then(function(e){var n=e[0],e=(e[1],e[2]);n.getIsOpen()?n.setPosition(t):n.open(e,t)}),l&&l.apply&&l.call(r,e))}),t.add(i),i.show(),lorryMap.set(r.amapResolve,i)),[i,n,t,e]})},drawLorryMove=function(e,i,n,t,a){return prepareLorryMarker(e,i=void 0===i?[]:i,n=void 0===n?"lorry":n,t,a).then(function(e){var n=e[0],t=(e[1],e[2]),e=e[3];clearShinning(n),n.stopMove();e=t.getResolution(e);return n.moveAlong(i.map(function(e){return[e.lng,e.lat]}),100*e),n})},infoWindowMap=new WeakMap,newInfoWindow=function(a,r){return confirmAmap(a).then(function(e){var n=e[0],t=e[1];if(!a.getInfoWindowContent)return Promise.reject("Don't known how to show the info window");var i=a.getInfoWindowContent(r),e=null;return infoWindowMap.has(a.amapResolve)?(e=infoWindowMap.get(a.amapResolve)).setContent(i):(e=new n.InfoWindow({content:i,offset:new n.Pixel(0,-8)}),infoWindowMap.set(a.amapResolve,e)),[e,n,t]})},moveLorryTo=function(i,e,n,a){void 0===n&&(n="lorry"),void 0===a&&(a=!1);var r=(e=void 0===e?[]:e).reverse();return prepareLorryMarker(i,r,n).then(function(e){var n=e[0],t=(e[1],e[2],e[3]);clearShinning(n),n.stopMove();e=r[0];return e&&(n.setPosition(t),a&&i.$emit("clickPoint",e),newInfoWindow(i,e).then(function(e){var n=e[0],e=(e[1],e[2]);n.getIsOpen()?n.setPosition(t):n.open(e,t)})),n})},showInfoWindowOfPoint=function(e,i){return newInfoWindow(e,i).then(function(e){var n=e[0],t=(e[1],e[2]),e=[i.lng,i.lat];n.getIsOpen()?n.setPosition(e):n.open(t,e)})},hideInfoWindow=function(n){return confirmAmap(n).then(function(){var e;return!infoWindowMap.has(n.amapResolve)||(e=infoWindowMap.get(n.amapResolve)).getIsOpen()&&e.close(),"ok"})},tracking=Object.freeze({__proto__:null,removeTrackLine:removeTrackLine,drawTrackLine:drawTrackLine,getValidPathArray:getValidPathArray,getTrackParts:getTrackParts,drawTrackPassPoint:drawTrackPassPoint,drawLorryMove:drawLorryMove,moveLorryTo:moveLorryTo,showInfoWindowOfPoint:showInfoWindowOfPoint,hideInfoWindow:hideInfoWindow,removePassPoint:removePassPoint}),map_utils=Object.freeze({__proto__:null,loadUnload:load_unload,tracking:tracking,base:map_base}),script$1={name:"AmapRoute",components:{log:__vue_component__},props:{className:String,loadPoint:Array,unloadPoint:Array,loadRule:Function,unloadRule:Function,amap:null,avoid:{type:Array,default:function(){return[10,10,10,10]}}},data:function(){return{amapResolve:null,amapId:uuid(),containerResolve:null}},mounted:function(){var e=this;e.amap&&(e.amapResolve||(e.amapResolve=Promise.resolve(e.amap)),e.drawRoute())},updated:function(){var e=this;e.amap&&(e.amapResolve||(e.amapResolve=Promise.resolve(e.amap)),e.drawRoute())},methods:{drawRoute:function(){var n=this;renderTheRoute(n).then(function(e){n.$emit("drawRoute",e)}).catch(function(e){console.log(e)})}}},__vue_script__$1=script$1,__vue_render__$1=function(){var e=this,n=e.$createElement;return(e._self._c||n)("div",{class:e.className,attrs:{id:e.amapId}},[e._e()],1)},__vue_staticRenderFns__$1=[];__vue_render__$1._withStripped=!0;var __vue_inject_styles__$1=void 0,__vue_scope_id__$1=void 0,__vue_module_identifier__$1=void 0,__vue_is_functional_template__$1=!1,__vue_component__$1=normalizeComponent({render:__vue_render__$1,staticRenderFns:__vue_staticRenderFns__$1},__vue_inject_styles__$1,__vue_script__$1,__vue_scope_id__$1,__vue_is_functional_template__$1,__vue_module_identifier__$1,!1,void 0,void 0,void 0),script$2={name:"IconContainer",props:{iconSrc:String,iconWidth:{type:[String,Number],default:24},iconHeight:{type:[String,Number],default:24},iconClass:String}},__vue_script__$2=script$2,__vue_render__$2=function(){var e=this,n=e.$createElement;return(e._self._c||n)("img",{class:e.iconClass,attrs:{src:e.iconSrc,width:e.iconWidth,height:e.iconHeight}})},__vue_staticRenderFns__$2=[];__vue_render__$2._withStripped=!0;var __vue_inject_styles__$2=void 0,__vue_scope_id__$2=void 0,__vue_module_identifier__$2=void 0,__vue_is_functional_template__$2=!1,__vue_component__$2=normalizeComponent({render:__vue_render__$2,staticRenderFns:__vue_staticRenderFns__$2},__vue_inject_styles__$2,__vue_script__$2,__vue_scope_id__$2,__vue_is_functional_template__$2,__vue_module_identifier__$2,!1,void 0,void 0,void 0),img$g="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='256' height='256' viewBox='0 0 256 256' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cpath d='M 48%2c16 H 80 V 240 H 48 V 16 Z' stroke='blue' fill='none' stroke-width='32'/%3e %3cpath d='M 176%2c16 H 208 V 240 H 176 V 16 Z' stroke='blue' fill='none' stroke-width='32'/%3e%3c/svg%3e",script$3={name:"PauseControl",components:{Icon:__vue_component__$2},props:{configs:{type:Object,default:function(){return{}}}},data:function(){return{imageData:img$g}}},__vue_script__$3=script$3,__vue_render__$3=function(){var e=this.$createElement;return(this._self._c||e)("icon",{attrs:{iconSrc:this.imageData}})},__vue_staticRenderFns__$3=[];__vue_render__$3._withStripped=!0;var __vue_inject_styles__$3=void 0,__vue_scope_id__$3=void 0,__vue_module_identifier__$3=void 0,__vue_is_functional_template__$3=!1,__vue_component__$3=normalizeComponent({render:__vue_render__$3,staticRenderFns:__vue_staticRenderFns__$3},__vue_inject_styles__$3,__vue_script__$3,__vue_scope_id__$3,__vue_is_functional_template__$3,__vue_module_identifier__$3,!1,void 0,void 0,void 0),img$h="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='256' height='256' viewBox='0 0 256 256' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cpath d='M 16%2c24 L 224%2c128 16%2c232 16%2c24 Z' stroke='blue' fill='none' stroke-width='32'/%3e%3c/svg%3e",script$4={name:"ResumeControl",components:{Icon:__vue_component__$2},props:{configs:{type:Object,default:function(){return{}}}},data:function(){return{imageData:img$h}}},__vue_script__$4=script$4,__vue_render__$4=function(){var e=this.$createElement;return(this._self._c||e)("icon",{attrs:{iconSrc:this.imageData}})},__vue_staticRenderFns__$4=[];__vue_render__$4._withStripped=!0;var __vue_inject_styles__$4=void 0,__vue_scope_id__$4=void 0,__vue_module_identifier__$4=void 0,__vue_is_functional_template__$4=!1,__vue_component__$4=normalizeComponent({render:__vue_render__$4,staticRenderFns:__vue_staticRenderFns__$4},__vue_inject_styles__$4,__vue_script__$4,__vue_scope_id__$4,__vue_is_functional_template__$4,__vue_module_identifier__$4,!1,void 0,void 0,void 0),img$i="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='256' height='256' viewBox='0 0 256 256' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3cpath d='M 16%2c16 L 240%2c16 240%2c240 16%2c240 Z' stroke='blue' fill='black' stroke-width='32'/%3e%3c/svg%3e",script$5={name:"StopControl",components:{Icon:__vue_component__$2},props:{configs:{type:Object,default:function(){return{}}}},data:function(){return{imageData:img$i}}},__vue_script__$5=script$5,__vue_render__$5=function(){var e=this.$createElement;return(this._self._c||e)("icon",{attrs:{iconSrc:this.imageData}})},__vue_staticRenderFns__$5=[];__vue_render__$5._withStripped=!0;var __vue_inject_styles__$5=void 0,__vue_scope_id__$5=void 0,__vue_module_identifier__$5=void 0,__vue_is_functional_template__$5=!1,__vue_component__$5=normalizeComponent({render:__vue_render__$5,staticRenderFns:__vue_staticRenderFns__$5},__vue_inject_styles__$5,__vue_script__$5,__vue_scope_id__$5,__vue_is_functional_template__$5,__vue_module_identifier__$5,!1,void 0,void 0,void 0),typeSwitch={primary:"info",info:"primary"},deviceMapping=glossary.deviceMapping,script$6={name:"WaybillTrack",components:{Pause:__vue_component__$3,Resume:__vue_component__$4,Stop:__vue_component__$5},props:{trackInfo:{type:Object,default:function(){return{}}},baseInfo:{type:Object,default:function(){return{}}},selectedPoint:Object,showDriverInfo:{type:Boolean,default:!0},driverInfo:{type:Object,default:function(){return{}}},amap:null,loadPoint:Array,unloadPoint:Array,loadRule:Function,unloadRule:Function,showTrackType:{type:Number,default:glossary.pathType.full},trackVehicleColor:{type:String,default:"#2288FF"},trackDriverColor:{type:String,default:"#D01F1F"},trackUnionColor:{type:String,default:"#2288FF"},showPlayBack:{type:Boolean,default:!0},vehicleType:{type:String,default:"lorry"},moveTriggerInfoWindow:{type:Boolean,default:!0},isRunning:{type:Boolean,default:!1},emitLastPosition:Boolean,pointDensity:{type:Number,default:30},trackUnionLine:Boolean,loadActionType:{type:[Number,String,Object],default:2},unloadActionType:{type:[Number,String,Object],default:3},avoid:Array,showPlayControlPanel:Boolean,getInfoWindowContentDom:Function,otherActionType:[Number,String,Object]},data:function(){return{meta:{loading:!1},amapId:uuid(),amapResolve:null,containerResolve:null,trackTypeOfVehicle:"primary",trackTypeOfDriver:"primary",trackPath:{},focusedPoint:null,playingTrack:!1,playingStatus:"stop",lorryMarker:null}},computed:{disablePlayTrack:function(){var e=this,n=!(!e.driverActive||!e.showDriverTrack),t=!(!e.vehicleActive||!e.showVehicleTrack),e=n&&t&&e.trackUnionLine;return!(n!=t||e)},showUnionTrack:function(){return this.showTrackType==glossary.pathType.union},showDriverTrack:function(){return this.showTrackType&glossary.pathType.driver},showVehicleTrack:function(){return this.showTrackType&glossary.pathType.vehicle},showPlayTrackController:function(){return!this.disablePlayTrack&&(this.playingTrack&&this.showPlayControlPanel)},driverActive:function(){return"primary"==this.trackTypeOfDriver},vehicleActive:function(){return"primary"==this.trackTypeOfVehicle}},mounted:function(){var e=this;callOnInitLifeCircle(e).then(function(){e.drawTrackAll()})},updated:function(){var e=this;callOnInitLifeCircle(e).then(function(){e.drawTrackAll()})},methods:{getActionRange:function(){var e=this,n=e.trackInfo&&e.trackInfo.driverOperate;return[findDriverActionList(n,e.loadActionType),findDriverActionList(n,e.unloadActionType),findDriverActionList(n,e.otherActionType)]},drawTrackAll:function(){var a=this;renderTheRoute(a).then(function(e){var n=a.getActionRange(),t=n[0],i=n[1],n=n[2];return Promise.all([renderTheAction(a,t,i,n),t,i,a.containerResolve])}).then(function(e){e[0];var n=e[1],t=e[2],e=e[3];a._handleDrawPassPoint||(e.on("zoomend",function(e){a.drawTrackPath(n,t)}),a._handleDrawPassPoint=a.drawTrackPath),a.drawTrackPath(n,t)}).then(function(e){return a.selectedPoint?showInfoWindowOfPoint(a,a.selectedPoint):hideInfoWindow(a)}).catch(function(e){console.log(e)})},drawTrackPath:function(e,n){var i=this,t=i.trackPath,a=i.trackInfo&&i.trackInfo.realtime.slice()||[],a=n.concat(a).concat(e).filter(function(e){return!!e}).reverse(),e=function(e,n,t){return void 0===t&&(t="lines"),getValidPathArray(i,e).then(function(e){e=getTrackParts(e);drawTrackLine(i,e,n,t),drawTrackPassPoint(i,e,t)})};return(i.showUnionTrack||i.showDriverTrack)&&(i.driverActive?t.driver=e(a.filter(function(e){return e.origin==glossary.pointType.app}),i.trackDriverColor,"driver"):(removeTrackLine(i,"driver"),removePassPoint(i,"driver"))),(i.showUnionTrack||i.showVehicleTrack)&&(i.vehicleActive?t.vehicle=e(a.filter(function(e){return e.origin!=glossary.pointType.app}),i.trackVehicleColor,"vehicle"):(removeTrackLine(i,"vehicle"),removePassPoint(i,"vehicle"))),Promise.all([t.all,t.driver,t.vehicle])},listenClickPlayback:function(){this.playingTrack=!0,this.handlePlayback().catch(function(e){console.log("err",e)})},handlePlayback:function(){var n=this;n.focusedPoint=null;function e(e){(n.lorryMarker=e).show(),n.playingStatus="playing"}var t=n.trackInfo&&n.trackInfo.realtime.slice()||[],i=n.showDriverTrack&&n.driverActive,a=n.showVehicleTrack&&n.vehicleActive;return n.showUnionTrack||i&&a?getValidPathArray(n,t).then(function(e){return drawLorryMove(n,e,n.vehicleType,n.handleAlongPlaying,n.handleStopPlaying)}).then(e):i?getValidPathArray(n,t.filter(function(e){return e.origin==glossary.pointType.app})).then(function(e){return drawLorryMove(n,e,n.vehicleType,n.handleAlongPlaying,n.handleStopPlaying)}).then(e):a?getValidPathArray(n,t.filter(function(e){return e.origin!=glossary.pointType.app})).then(function(e){return drawLorryMove(n,e,n.vehicleType,n.handleAlongPlaying,n.handleStopPlaying)}).then(e):Promise.reject("未知的操作类型")},resumePlaying:function(){this.lorryMarker&&(this.playingStatus="playing",this.lorryMarker.resumeMove())},pausePlaying:function(){this.lorryMarker&&(this.lorryMarker.pauseMove(),this.playingStatus="pause")},stopPlaying:function(){var e=this;e.lorryMarker&&(e.lorryMarker.stopMove(),e.lorryMarker.hide(),e.playingStatus="",e.playingTrack=!1)},handleStopPlaying:function(e){this.lorryMarker&&console.log("stop event",e)},handleAlongPlaying:function(e){},changeTrack:function(e){var n=this,t=n.getActionRange(),i=t[0],a=t[1];switch(e){case"vehicle":n.trackTypeOfVehicle=typeSwitch[n.trackTypeOfVehicle],n.drawTrackPath(i,a);break;case"driver":n.trackTypeOfDriver=typeSwitch[n.trackTypeOfDriver],n.drawTrackPath(i,a);break;default:return}},getInfoWindowContent:function(e){var n=this,t=[];return n.getInfoWindowContentDom&&n.getInfoWindowContentDom.call?n.getInfoWindowContentDom(e):(e.velocity&&(t=['<div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">速度</div><span style="font-size:12px">',e.velocityLabel,"</span></div>"]),['\n      <div style="width:220px;padding:8px">\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">经度</div><span style="font-size:12px">'+(+e.lng||0).toFixed(6)+'</span></div>\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">纬度</div><span style="font-size:12px">'+(+e.lat||0).toFixed(6)+'</span></div>\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">时间</div><span style="font-size:12px">'+e.trackTimeLabel+'</span></div>\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">设备</div><span style="font-size:12px">'+deviceMapping[e.origin]+"</span></div>\n        "+t.join("")+"\n      ",n.baseInfo&&4!=n.baseInfo.type?'\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;"><div style="width:30px;font-size:12px;">实时位置</div></div><div style="flex:1"><span style="font-size:12px">'+e.addressInfo+"</span></div></div>\n      ":"","\n      </div>\n      "].join(""))},moveToEnd:function(e){var n=this;n.focusedPoint=e;var t=n.trackInfo&&n.trackInfo.realtime.slice()||[];switch(e){case"driver":return getValidPathArray(n,t.filter(function(e){return e.origin==glossary.pointType.app})).then(function(e){return e.length?moveLorryTo(n,e,n.vehicleType,n.emitLastPosition):hideInfoWindow(n)});case"vehicle":return getValidPathArray(n,t.filter(function(e){return e.origin!=glossary.pointType.app})).then(function(e){return e.length?moveLorryTo(n,e,n.vehicleType,n.emitLastPosition):hideInfoWindow(n)})}}}},img$j="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='52px' height='52px' viewBox='0 0 52 52' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3ctitle%3e%e7%bc%96%e7%bb%84 4%3c/title%3e %3cdefs%3e %3clinearGradient x1='-12.313058%25' y1='-14.7070312%25' x2='109.143415%25' y2='108.638393%25' id='linearGradient-1'%3e %3cstop stop-color='%23F1DCC4' offset='0%25'%3e%3c/stop%3e %3cstop stop-color='%23AE9484' offset='100%25'%3e%3c/stop%3e %3c/linearGradient%3e %3crect id='path-2' x='0' y='0' width='52' height='52' rx='3.57142857'%3e%3c/rect%3e %3cpath d='M22.1207049%2c27.7447245 C25.7254001%2c27.7447245 28.565433%2c24.7734665 29.6418686%2c22.5208687 C31.1577996%2c19.3485629 31.4216947%2c13.8438427 31.4216947%2c9.53771013 C31.4216947%2c1.66531625 26.0844392%2c1.9356158 21.6270304%2c1.9356158 C17.1696215%2c1.9356158 12.7759675%2c1.66531625 12.7759675%2c9.53771013 C12.7759675%2c13.8803566 13.0253319%2c19.3517497 14.5858142%2c22.5208687 C15.856767%2c25.1019943 18.5160098%2c27.7447245 22.1207049%2c27.7447245 Z' id='path-4'%3e%3c/path%3e %3c/defs%3e %3cg id='2020.04.03--%e5%9c%b0%e5%9b%be%e4%bc%98%e5%8c%96' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='A4-1--2-%e8%bf%90%e5%8d%95%e8%bd%a8%e8%bf%b9-%e5%ae%9e%e6%97%b6%e8%bd%a8%e8%bf%b9' transform='translate(-286.000000%2c -579.000000)'%3e %3cg id='%e7%bc%96%e7%bb%84-4' transform='translate(286.000000%2c 579.000000)'%3e %3cmask id='mask-3' fill='white'%3e %3cuse xlink:href='%23path-2'%3e%3c/use%3e %3c/mask%3e %3cuse id='%e8%92%99%e7%89%88' fill='url(%23linearGradient-1)' xlink:href='%23path-2'%3e%3c/use%3e %3cg id='%e7%bc%96%e7%bb%84-11' mask='url(%23mask-3)'%3e %3cg transform='translate(3.714286%2c 7.239230)'%3e %3cpath d='M5.59704302%2c36.0225499 C11.1756725%2c31.9513992 16.7077196%2c29.9158238 22.1931845%2c29.9158238 C27.7082279%2c29.9158238 33.2157485%2c31.9734106 38.7157465%2c36.0885843 C40.5745998%2c37.4793988 41.9314169%2c39.4363531 42.581989%2c41.6649079 L44.3089983%2c47.5808312 L44.3089983%2c47.5808312 L5.27831747e-14%2c47.5808312 L1.58343856%2c41.8320749 C2.22642151%2c39.4976789 3.64115899%2c37.4499074 5.59704302%2c36.0225499 Z' id='Rectangle%e5%a4%87%e4%bb%bd-11' stroke='none' fill='%23A88269' fill-rule='evenodd'%3e%3c/path%3e %3cpath d='M25.2320359%2c30.3361024 C26.0891119%2c30.0677211 26.760568%2c29.876567 27.2464041%2c29.7626402 C27.7174612%2c29.652179 28.356183%2c29.5269308 29.1625695%2c29.3868956 L29.1625776%2c29.3869425 C29.3180205%2c29.3599486 29.4659148%2c29.4640771 29.4929086%2c29.61952 C29.4938488%2c29.6249338 29.4946325%2c29.6303736 29.4952589%2c29.6358326 C29.7854488%2c32.1649064 29.9305437%2c34.9799924 29.9305437%2c38.0810905 C29.9305437%2c41.3053471 29.6273402%2c44.0509031 29.0209334%2c46.3177587 L24.2856429%2c50.8905755 C25.0166065%2c45.6204602 25.3820884%2c41.4281165 25.3820884%2c38.3135446 C25.3820884%2c35.3102943 25.2658659%2c32.7524563 25.033421%2c30.6400308 L25.0334015%2c30.640033 C25.0184625%2c30.5042694 25.1016938%2c30.3769172 25.2320359%2c30.3361024 Z' id='%e7%9f%a9%e5%bd%a2' stroke='none' fill='%234E3838' fill-rule='evenodd' transform='translate(27.108093%2c 40.113219) rotate(44.000000) translate(-27.108093%2c -40.113219) '%3e%3c/path%3e %3cpolygon id='Rectangle%e5%a4%87%e4%bb%bd-13' stroke='none' fill='%23FFDAC2' fill-rule='evenodd' points='17.778095 22.0361607 26.7933336 22.0361607 26.6352769 32.1572719 18.0816288 32.1572719'%3e%3c/polygon%3e %3cpath d='M17.9132764%2c30.0950182 C19.0827529%2c31.1786715 20.5811384%2c31.7204982 22.4084328%2c31.7204982 C24.2099068%2c31.7204982 25.5784294%2c31.215928 26.5140005%2c30.2067876 C26.6326397%2c30.0787273 26.8171048%2c30.0354764 26.980324%2c30.0973971 L28.1441118%2c30.5389048 C28.2548882%2c30.580777 28.3105964%2c30.7045905 28.2685903%2c30.8153162 C28.2611579%2c30.8349075 28.250894%2c30.8533036 28.238126%2c30.869918 C26.9348872%2c32.5657574 24.9916562%2c33.4136771 22.4084328%2c33.4136771 C19.8269576%2c33.4136771 17.7280875%2c32.5473895 16.1118225%2c30.8148142 C16.0311948%2c30.7282508 16.0359023%2c30.592712 16.1224035%2c30.5120177 C16.1436322%2c30.4922141 16.1686652%2c30.4769328 16.1959817%2c30.4671019 L17.4768561%2c30.0061311 C17.6275119%2c29.9519064 17.7958291%2c29.9861898 17.9132764%2c30.0950182 Z' id='%e8%b7%af%e5%be%84-21%e5%a4%87%e4%bb%bd' stroke='none' fill='%23CFAB8E' fill-rule='evenodd'%3e%3c/path%3e %3cpath d='M12.4947703%2c19.1782786 C14.1143741%2c19.3485058 15.5975922%2c17.8664933 15.7902702%2c16.0332846 C15.9829482%2c14.200076 14.7121412%2c13.661132 13.0925373%2c13.4909047 C11.4729335%2c13.3206775 10.1178439%2c13.5836287 9.92516593%2c15.4168373 C9.73248793%2c17.250046 10.8751664%2c19.0080514 12.4947703%2c19.1782786 Z' id='Oval%e5%a4%87%e4%bb%bd' stroke='none' fill='%23FFDAC2' fill-rule='evenodd'%3e%3c/path%3e %3cpath d='M31.7028919%2c19.1782786 C30.0832881%2c19.3485058 28.60007%2c17.8664933 28.407392%2c16.0332846 C28.214714%2c14.200076 29.485521%2c13.661132 31.1051249%2c13.4909047 C32.7247287%2c13.3206775 34.0798183%2c13.5836287 34.2724963%2c15.4168373 C34.4651743%2c17.250046 33.3224958%2c19.0080514 31.7028919%2c19.1782786 Z' id='Oval%e5%a4%87%e4%bb%bd-2' stroke='none' fill='%23FFDAC2' fill-rule='evenodd'%3e%3c/path%3e %3cmask id='mask-5' fill='white'%3e %3cuse xlink:href='%23path-4'%3e%3c/use%3e %3c/mask%3e %3cuse id='%e8%92%99%e7%89%88' stroke='none' fill='%23FFE7D6' fill-rule='evenodd' xlink:href='%23path-4'%3e%3c/use%3e %3cpath d='M23.1353149%2c18.7568947 C23.3427459%2c17.6638684 22.8984572%2c16.2390176 22.4833281%2c15.5891022 C22.3430834%2c15.3695386 21.8605422%2c15.3656585 21.7235133%2c15.5790553 C21.3077097%2c16.226591 20.8575369%2c17.6674459 21.059513%2c18.7538274 C21.1057483%2c19.002516 23.0943996%2c18.9724917 23.1353149%2c18.7568947 Z' id='%e6%a4%ad%e5%9c%86%e5%bd%a2%e5%a4%87%e4%bb%bd-7' stroke='none' fill='%23FBD3B9' fill-rule='evenodd'%3e%3c/path%3e %3cpath d='M20.2123289%2c21.9654824 C20.7987034%2c22.3201607 21.4863308%2c22.5242881 22.2216347%2c22.5242881 C22.9332852%2c22.5242881 23.6002772%2c22.3330823 24.1740402%2c21.9992414' id='%e8%b7%af%e5%be%84%e5%a4%87%e4%bb%bd-5' stroke='%23EE9585' stroke-width='0.857142857' fill='none' stroke-linecap='round'%3e%3c/path%3e %3cpath d='M12.8459583%2c14.0776 C12.5412311%2c13.6536928 12.0974331%2c13.466828 11.5145645%2c13.5170059 C11.3937709%2c12.1889509 11.0380542%2c6.60754063 12.7759675%2c3.84813058 C14.3666504%2c1.32248884 17.0277581%2c5.03089633e-14 22.061829%2c5.03089633e-14 C26.6055558%2c5.03089633e-14 29.7540039%2c1.27869001 31.3063946%2c3.84813058 C32.7761508%2c6.2807986 32.9449707%2c12.2186035 32.7849923%2c13.5485105 C32.1323012%2c13.4932268 31.6394353%2c13.6695899 31.3063946%2c14.0776 C31.3063946%2c11.9349587 29.8240095%2c8.30980748 29.1999442%2c7.87816685 C28.5758789%2c7.44652623 28.5758789%2c8.37600446 22.0988311%2c8.50332031 C15.6217833%2c8.63063616 15.0919608%2c7.51929757 14.5972934%2c7.87816685 C14.1026259%2c8.23703613 12.7936538%2c11.9349587 12.8459583%2c14.0776 Z' id='%e8%b7%af%e5%be%84-19%e5%a4%87%e4%bb%bd' stroke='none' fill='%2348433D' fill-rule='evenodd'%3e%3c/path%3e %3cpath d='M6.93500056%2c44.9290737 C7.18165235%2c42.6286135 8.02144727%2c40.7585486 8.35415514%2c40.8879048 C8.68686301%2c41.017261 8.35112208%2c43.2534042 8.61953251%2c44.9290737 C8.61953251%2c44.9290737 6.93500056%2c44.9290737 6.93500056%2c44.9290737 Z' id='%e8%b7%af%e5%be%84-22' stroke='none' fill='%23966D52' fill-rule='evenodd'%3e%3c/path%3e %3cpath d='M35.2447767%2c44.9290737 C35.4914284%2c42.6286135 36.3312234%2c40.7585486 36.6639312%2c40.8879048 C36.9966391%2c41.017261 36.6608982%2c43.2534042 36.9293086%2c44.9290737 C36.9293086%2c44.9290737 35.2447767%2c44.9290737 35.2447767%2c44.9290737 Z' id='%e8%b7%af%e5%be%84-22' stroke='none' fill='%23966D52' fill-rule='evenodd' transform='translate(36.087043%2c 42.905324) scale(-1%2c 1) translate(-36.087043%2c -42.905324) '%3e%3c/path%3e %3c/g%3e %3c/g%3e %3c/g%3e %3c/g%3e %3c/g%3e%3c/svg%3e",__vue_script__$6=script$6,__vue_render__$6=function(){var n=this,e=n.$createElement,e=n._self._c||e;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:n.meta.loading,expression:"meta.loading"}],staticClass:"track-amap-container"},[e("div",{staticClass:"track-amap height-100p min-height-700",attrs:{id:n.amapId,trackInfo:n.trackInfo,selectedPoint:n.selectedPoint}}),n._v(" "),n.showDriverInfo?e("div",{staticClass:"driver-info"},[n._m(0),n._v(" "),e("div",{staticClass:"user-info"},[e("span",{staticClass:"user-name"},[n._v(n._s(n.driverInfo.driverName))]),n._v(" "),e("span",{staticClass:"user-phone"},[n._v(n._s(n.driverInfo.driverPhone))]),n._v(" "),e("div",{staticClass:"user-phone plate-code"},[e("span",[n._v(n._s(n.driverInfo.carPlate))])])]),n._v(" "),e("div",{staticClass:"track-playback"},[n.showPlayBack?e("el-button",{staticClass:"trackbutton margin-bottom-8",attrs:{disabled:n.disablePlayTrack,plain:"",type:"default",size:"mini"},on:{click:n.listenClickPlayback}},[n._v("轨迹回放")]):n._e()],1)]):n._e(),n._v(" "),e("div",{staticClass:"track-tabs"},[e("div",{staticClass:"flex-row"},[n.showVehicleTrack?e("el-button",{staticStyle:{width:"116px"},attrs:{type:n.trackTypeOfVehicle,size:"mini"},on:{click:function(e){return n.changeTrack("vehicle")}}},[n._v("车辆轨迹")]):n._e(),n._v(" "),n.showDriverTrack?e("el-button",{staticStyle:{width:"116px"},attrs:{type:n.trackTypeOfDriver,size:"mini"},on:{click:function(e){return n.changeTrack("driver")}}},[n._v("司机轨迹")]):n._e()],1),n._v(" "),e("div",{staticClass:"flex-row padding-top-4"},[n.showVehicleTrack?e("el-button",{attrs:{type:"default",size:"mini"},on:{click:function(e){return n.moveToEnd("vehicle")}}},[n._v("车辆实时位置")]):n._e(),n._v(" "),n.showDriverTrack?e("el-button",{attrs:{type:"default",size:"mini"},on:{click:function(e){return n.moveToEnd("driver")}}},[n._v("司机实时位置")]):n._e()],1)]),n._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:n.showPlayTrackController,expression:"showPlayTrackController"}],staticClass:"track-playing"},[e("div",{staticClass:"flex-row track-control"},[e("span",{directives:[{name:"show",rawName:"v-show",value:"pause"==n.playingStatus,expression:"playingStatus == 'pause'"}],on:{click:n.resumePlaying}},[e("resume")],1),n._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:"playing"==n.playingStatus,expression:"playingStatus == 'playing'"}],on:{click:n.pausePlaying}},[e("pause")],1),n._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:"stop"!=n.playingStatus,expression:"playingStatus != 'stop'"}],on:{click:n.stopPlaying}},[e("stop")],1)]),n._v(" "),n._e()])])},__vue_staticRenderFns__$6=[function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"user-avatar"},[e("img",{attrs:{src:img$j,alt:""}})])}];__vue_render__$6._withStripped=!0;var __vue_inject_styles__$6=function(e){e&&e("data-v-1d0c4e3c_0",{source:"\n.track-amap-container {\n  flex: 1;\n  width: 100%;\n  height: 100%;\n  background: coral;\n}\n.track-amap {\n  min-width: 200px;\n  min-height: 200px;\n  flex: 1;\n}\n.driver-info {\n  position: absolute;\n  top: 20px;\n  left: 20px;\n  padding:8px;\n  border-radius:4px;\n  background:#ffffffa0;\n  display:flex;\n  flex-direction: row;\n  align-items: center;\n}\n.track-tabs {\n  background: transparent;\n  position: absolute;\n  top: 120px;\n  left: 20px;\n}\n.user-avatar {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  margin-right: 10px;\n}\n.user-avatar img {\n  width: 100%;\n  height: 100%;\n  opacity: 0.95;\n}\n.user-info {\n  width: 180px;\n  height: 60px;\n  padding: 0 10px;\n  color:#000000a0;\n}\n.user-name {\n  margin-right: 10px;\n}\n.user-phone {\n  line-height: 30px;\n}\n.plate-code >span {\n  background-color: #FAECD880;\n  padding:0 4px;\n  color: #61503A;\n  border-radius: 2px;\n}\n.height-100p {\n  height: 100%;\n}\n.min-height-400 {\n  min-height: 400px;\n}\n.min-height-700 {\n  min-height: 700px;\n}\n.amap-logo,\n.amap-copyright {\n  display: none !important;\n}\n.track-playback {\n  color:#000000a0;\n  display: flex;\n  flex-direction:column;\n  padding: 0 10px;\n  align-items: center;\n  justify-content:space-between;\n}\n.track-playback .el-button + .el-button {\n  margin-left:0;\n}\n.el-button.trackbutton {\n  background-color: #ffffff80;\n  border-color: #409EFF40;\n  color:#409EFF;\n  border-radius: 6px;\n  padding-bottom:5px !important;\n  padding-top:5px !important;\n}\n.trackbutton > span {\n  font-size: 12px;\n  font-weight: 700;\n  background: transparent;\n}\n.el-button.trackbutton:hover {\n  background-color: #409EFF18;\n  border-color: #409EFF00;\n  box-shadow: unset;\n}\n.track-playing {\n  background: transparent;\n  position: absolute;\n  left: 20px;\n  bottom: 20px;\n}\n.track-control {\n  min-width:100px;\n  justify-content: space-evenly;\n}\n.track-control > span {\n  display:inline-block;\n  height:14px;\n  width:14px;\n  background-size:contain;\n  background-repeat:no-repeat;\n}\n",map:{version:3,sources:["/media/liuhanru/mywork/apps/dayi/admin-widget/src/waybill/WaybillTrack.vue"],names:[],mappings:";AA6VA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,iBAAA;AACA;AACA;EACA,gBAAA;EACA,iBAAA;EACA,OAAA;AACA;AACA;EACA,kBAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,iBAAA;EACA,oBAAA;EACA,YAAA;EACA,mBAAA;EACA,mBAAA;AACA;AACA;EACA,uBAAA;EACA,kBAAA;EACA,UAAA;EACA,UAAA;AACA;AACA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,kBAAA;AACA;AACA;EACA,WAAA;EACA,YAAA;EACA,aAAA;AACA;AACA;EACA,YAAA;EACA,YAAA;EACA,eAAA;EACA,eAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,2BAAA;EACA,aAAA;EACA,cAAA;EACA,kBAAA;AACA;AACA;EACA,YAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;EACA,iBAAA;AACA;AACA;;EAEA,wBAAA;AACA;AACA;EACA,eAAA;EACA,aAAA;EACA,qBAAA;EACA,eAAA;EACA,mBAAA;EACA,6BAAA;AACA;AACA;EACA,aAAA;AACA;AACA;EACA,2BAAA;EACA,uBAAA;EACA,aAAA;EACA,kBAAA;EACA,6BAAA;EACA,0BAAA;AACA;AACA;EACA,eAAA;EACA,gBAAA;EACA,uBAAA;AACA;AACA;EACA,2BAAA;EACA,uBAAA;EACA,iBAAA;AACA;AAEA;EACA,uBAAA;EACA,kBAAA;EACA,UAAA;EACA,YAAA;AACA;AACA;EACA,eAAA;EACA,6BAAA;AACA;AACA;EACA,oBAAA;EACA,WAAA;EACA,UAAA;EACA,uBAAA;EACA,2BAAA;AACA",file:"WaybillTrack.vue",sourcesContent:['<template>\n  <div class="track-amap-container" v-loading="meta.loading">\n    <div class="track-amap height-100p min-height-700" :id="amapId" :trackInfo="trackInfo" :selectedPoint="selectedPoint"></div>\n    <div class="driver-info" v-if="showDriverInfo">\n      <div class="user-avatar">\n        <img src="./assets/carrior_portrait.svg" alt />\n      </div>\n      <div class="user-info">\n        <span class="user-name">{{driverInfo.driverName}}</span>\n        <span class="user-phone">{{driverInfo.driverPhone}}</span>\n        <div class="user-phone plate-code"><span>{{driverInfo.carPlate}}</span></div>\n      </div>\n      <div class="track-playback">\n        <el-button v-if="showPlayBack" :disabled="disablePlayTrack" plain type="default" size="mini" @click="listenClickPlayback" class="trackbutton margin-bottom-8">轨迹回放</el-button>\n        \x3c!-- <el-button \n         plain type="default" size="mini" @click="refreshTrack" class="trackbutton margin-bottom-8"\n         v-if="baseInfo.waybillStatus == 3"\n        >实时位置</el-button> --\x3e\n      </div>\n    </div>\n    <div class="track-tabs">\n      <div class="flex-row" v-if="true">\n        <el-button style="width:116px" v-if="showVehicleTrack" :type="trackTypeOfVehicle" size="mini" @click="changeTrack(\'vehicle\')">车辆轨迹</el-button>\n        <el-button style="width:116px" v-if="showDriverTrack" :type="trackTypeOfDriver" size="mini" @click="changeTrack(\'driver\')">司机轨迹</el-button>\n      </div>\n      <div class="flex-row padding-top-4" v-if="true">\n        <el-button v-if="showVehicleTrack" type="default" size="mini" @click="moveToEnd(\'vehicle\')">车辆实时位置</el-button>\n        <el-button v-if="showDriverTrack" type="default" size="mini" @click="moveToEnd(\'driver\')">司机实时位置</el-button>\n      </div>\n    </div>\n    <div class="track-playing" v-show="showPlayTrackController">\n      <div class="flex-row track-control">\n        <span @click="resumePlaying" v-show="playingStatus == \'pause\'"><resume /></span>\n        <span @click="pausePlaying" v-show="playingStatus == \'playing\'"><pause /></span>\n        <span @click="stopPlaying" v-show="playingStatus != \'stop\'"><stop /></span>\n      </div>\n      <div class="flex-row" v-if="false">\n        <input type="range" ref="playTrackProgressController"></input>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport * as simpleUUIdv4 from \'simple-uuidv4\';\nimport * as mapUtils from \'./lib/map.utils.js\';\nimport Pause from \'./components/Pause.vue\';\nimport Resume from \'./components/Resume.vue\';\nimport Stop from \'./components/Stop.vue\';\nconst typeSwitch = {\n  primary:\'info\', info:\'primary\'\n};\nconst deviceMapping = mapUtils.base.glossary.deviceMapping;\nexport default {\n  name:\'WaybillTrack\',\n  components: {\n    Pause, Resume, Stop,\n  },\n  props: {\n    trackInfo: { type: Object, default() { return {}; }, },\n    baseInfo: { type: Object, default() { return {}; }, },\n    selectedPoint: Object,\n    showDriverInfo: { type: Boolean, default: true, },\n    driverInfo: { type: Object, default() { return {}; }, },\n    amap: null,\n    loadPoint:Array,\n    unloadPoint:Array,\n    loadRule:Function,\n    unloadRule:Function,\n    showTrackType:{\n      type: Number, default: mapUtils.base.glossary.pathType.full\n    },\n    trackVehicleColor:{ type:String, default:"#2288FF", },\n    trackDriverColor:{ type:String, default:"#D01F1F", },\n    trackUnionColor:{ type:String, default:"#2288FF", },\n    showPlayBack:{ type:Boolean, default:true },\n    vehicleType:{ type:String, default:\'lorry\', },\n    moveTriggerInfoWindow:{ type:Boolean, default: true, },\n    isRunning:{ type:Boolean, default:false, },\n    emitLastPosition:Boolean,\n    pointDensity: { type: Number, default: 30 },\n    trackUnionLine: Boolean,\n    loadActionType: { type: [Number, String, Object], default:2 },\n    unloadActionType: { type: [Number, String, Object], default:3 },\n    avoid:Array,\n    showPlayControlPanel: Boolean,\n    getInfoWindowContentDom: Function,\n    otherActionType: [Number, String, Object], \n  },\n  data(){\n    const uuid = simpleUUIdv4.uuid();\n    return {\n      meta: {\n        loading: false,\n      },\n      amapId: uuid,\n      amapResolve: null,\n      containerResolve: null,\n      trackTypeOfVehicle:\'primary\',\n      trackTypeOfDriver:\'primary\',\n      trackPath:{},\n      focusedPoint:null,\n      playingTrack:false,\n      playingStatus:\'stop\',\n      lorryMarker:null,\n    };\n  },\n  computed:{\n    disablePlayTrack() {\n      const vue = this;\n      const moveDriver = !!(vue.driverActive && vue.showDriverTrack);\n      const moveVehicle = !!(vue.vehicleActive && vue.showVehicleTrack);\n      const onlyOneSelect = moveDriver != moveVehicle;\n      const couldMoveUnion = moveDriver && moveVehicle && vue.trackUnionLine;\n      const disabled = !(onlyOneSelect || couldMoveUnion);\n      return disabled;\n    },\n    showUnionTrack(){\n      const vue = this;\n      return vue.showTrackType == mapUtils.base.glossary.pathType.union;\n    },\n    showDriverTrack() {\n      const vue = this;\n      return (vue.showTrackType & mapUtils.base.glossary.pathType.driver);\n    },\n    showVehicleTrack(){\n      const vue = this;\n      return (vue.showTrackType & mapUtils.base.glossary.pathType.vehicle);\n    },\n    showPlayTrackController() {\n      const vue = this;\n      if(vue.disablePlayTrack) return false;\n      return vue.playingTrack && vue.showPlayControlPanel;\n    },\n    driverActive() {\n      const vue = this;\n      return vue.trackTypeOfDriver == \'primary\';\n    },\n    vehicleActive() {\n      const vue = this;\n      return vue.trackTypeOfVehicle == \'primary\';\n    },\n  },\n  mounted() {\n    const vue = this;\n    mapUtils.base.callOnInitLifeCircle(vue).then(()=>{\n      vue.drawTrackAll();\n    });\n  },\n  updated() {\n    const vue = this;\n    mapUtils.base.callOnInitLifeCircle(vue).then(()=>{\n      vue.drawTrackAll();      \n    })\n  },\n  methods: {\n    getActionRange(){\n      const vue = this;\n      const driverAction = vue.trackInfo && vue.trackInfo.driverOperate;\n      const startPointList = mapUtils.loadUnload.findDriverActionList(driverAction, vue.loadActionType);\n      const endPointList = mapUtils.loadUnload.findDriverActionList(driverAction, vue.unloadActionType);\n      const otherPointList = mapUtils.loadUnload.findDriverActionList(driverAction, vue.otherActionType);\n      return [startPointList, endPointList, otherPointList];\n    },\n    drawTrackAll() {\n      const vue = this;\n      mapUtils.loadUnload.renderTheRoute(vue).then(ok => {\n        const [startPointList, endPointList, otherPointList] = vue.getActionRange();\n        return Promise.all([mapUtils.loadUnload.renderTheAction(vue, startPointList, endPointList, otherPointList), startPointList, endPointList, vue.containerResolve]);\n      }).then(([ok, startPointList, endPointList, container]) => {\n        if(!vue._handleDrawPassPoint) {\n          container.on(\'zoomend\', (event) =>{\n            vue.drawTrackPath(startPointList, endPointList);\n          });\n          vue._handleDrawPassPoint = vue.drawTrackPath;\n        }\n        vue.drawTrackPath(startPointList, endPointList);\n      }).then(ok => {\n        if(!vue.selectedPoint) return mapUtils.tracking.hideInfoWindow(vue);\n        return mapUtils.tracking.showInfoWindowOfPoint(vue, vue.selectedPoint);\n      }).catch(err=>{\n        console.log(err);\n      });\n    },\n    drawTrackPath(startPointList, endPointList) {\n      const vue = this;\n      const trackPath =  vue.trackPath;\n      const copy = vue.trackInfo && vue.trackInfo.realtime.slice() || [];\n      const realtime = endPointList.concat(copy).concat(startPointList).filter(ele => !!ele).reverse();\n      const drawTrackPathHandle = (pathArray, pathColor, category="lines") => {\n        return mapUtils.tracking.getValidPathArray(vue, pathArray).then((paths) => {\n          const trackParts = mapUtils.tracking.getTrackParts(paths);\n          mapUtils.tracking.drawTrackLine(vue, trackParts, pathColor, category);\n          mapUtils.tracking.drawTrackPassPoint(vue, trackParts, category);\n        });\n      };\n      if ((vue.showUnionTrack || vue.showDriverTrack)) {\n        if(vue.driverActive) {\n          trackPath.driver = drawTrackPathHandle(realtime.filter(ele=> ele.origin == mapUtils.base.glossary.pointType.app), vue.trackDriverColor, \'driver\');\n        } else {\n          mapUtils.tracking.removeTrackLine(vue, \'driver\');\n          mapUtils.tracking.removePassPoint(vue, \'driver\');\n        }\n      };\n      if ((vue.showUnionTrack || vue.showVehicleTrack)) {\n        if(vue.vehicleActive) {\n          trackPath.vehicle = drawTrackPathHandle(realtime.filter(ele=> ele.origin != mapUtils.base.glossary.pointType.app), vue.trackVehicleColor, \'vehicle\');\n        } else {\n          mapUtils.tracking.removeTrackLine(vue, \'vehicle\');\n          mapUtils.tracking.removePassPoint(vue, \'vehicle\');\n        }\n      };\n      return Promise.all([trackPath.all, trackPath.driver, trackPath.vehicle]);\n    },\n    listenClickPlayback(){\n      const vue = this;\n      vue.playingTrack = true;\n      vue.handlePlayback().catch(err => {\n        console.log(\'err\', err);\n      });\n    },\n    handlePlayback() {\n      const vue = this;\n      vue.focusedPoint = null;\n      const realtime = vue.trackInfo && vue.trackInfo.realtime.slice() || [];\n      const willMoveDriver = vue.showDriverTrack && vue.driverActive;\n      const willMoveVehicle = vue.showVehicleTrack && vue.vehicleActive;\n      const willMoveOnUnion = vue.showUnionTrack || (willMoveDriver && willMoveVehicle);\n      const defineLorryMarker = (lorryMarker) => {\n        vue.lorryMarker = lorryMarker;\n        lorryMarker.show();\n        vue.playingStatus = \'playing\';\n      };\n      if (willMoveOnUnion) {\n        return mapUtils.tracking.getValidPathArray(vue, realtime).then((paths) => {\n          return mapUtils.tracking.drawLorryMove(vue, paths, vue.vehicleType, vue.handleAlongPlaying, vue.handleStopPlaying);\n        }).then(defineLorryMarker);\n      } else if (willMoveDriver) {\n        return mapUtils.tracking.getValidPathArray(vue, realtime.filter(ele => ele.origin == mapUtils.base.glossary.pointType.app)).then((paths) => {\n          return mapUtils.tracking.drawLorryMove(vue, paths, vue.vehicleType, vue.handleAlongPlaying, vue.handleStopPlaying);\n        }).then(defineLorryMarker);\n      } else if (willMoveVehicle) {\n        return mapUtils.tracking.getValidPathArray(vue, realtime.filter(ele => ele.origin != mapUtils.base.glossary.pointType.app)).then((paths) => {\n          return mapUtils.tracking.drawLorryMove(vue, paths, vue.vehicleType, vue.handleAlongPlaying, vue.handleStopPlaying);\n        }).then(defineLorryMarker);\n      } else {\n        return Promise.reject(\'未知的操作类型\');\n      }\n    },\n    resumePlaying() {\n      const vue = this;\n      if(!vue.lorryMarker) return;\n      vue.playingStatus = \'playing\';\n      vue.lorryMarker.resumeMove();\n    },\n    pausePlaying() {\n      const vue = this;\n      if(!vue.lorryMarker) return;\n      vue.lorryMarker.pauseMove();\n      vue.playingStatus = \'pause\';\n    },\n    stopPlaying() {\n      const vue = this;\n      if(!vue.lorryMarker) return;\n      vue.lorryMarker.stopMove();\n      vue.lorryMarker.hide();\n      vue.playingStatus = \'\';\n      vue.playingTrack = false;\n    },\n    handleStopPlaying(event) {\n      const vue = this;\n      if(!vue.lorryMarker) return;\n      // vue.playingStatus = \'stop\';\n      console.log(\'stop event\', event);\n    },\n    handleAlongPlaying(event) {\n      const vue = this;\n      // console.log(\'along event\', event);\n    },\n    changeTrack(target){\n      const vue = this;\n      const [startPointList, endPointList] = vue.getActionRange();\n      switch(target) {\n      case \'vehicle\':\n        vue.trackTypeOfVehicle = typeSwitch[vue.trackTypeOfVehicle];\n        vue.drawTrackPath(startPointList, endPointList);\n        break;\n      case \'driver\':\n        vue.trackTypeOfDriver = typeSwitch[vue.trackTypeOfDriver];\n        vue.drawTrackPath(startPointList, endPointList);\n        break;\n      default:\n        return;\n      }\n    },\n    getInfoWindowContent(trackInfo){\n      const vue = this;\n      let velocity = [];\n      if(vue.getInfoWindowContentDom && vue.getInfoWindowContentDom.call) {\n        return vue.getInfoWindowContentDom(trackInfo);\n      }\n      if (trackInfo.velocity) {\n        velocity=[\n          \'<div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">速度</div><span style="font-size:12px">\',\n          trackInfo.velocityLabel,\n          \'</span></div>\'\n        ];\n      };\n      return [`\n      <div style="width:220px;padding:8px">\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">经度</div><span style="font-size:12px">${(trackInfo.lng*1 || 0).toFixed(6)}</span></div>\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">纬度</div><span style="font-size:12px">${(trackInfo.lat*1 || 0).toFixed(6)}</span></div>\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">时间</div><span style="font-size:12px">${trackInfo.trackTimeLabel}</span></div>\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;font-size:12px">设备</div><span style="font-size:12px">${deviceMapping[trackInfo.origin]}</span></div>\n        ${velocity.join(\'\')}\n      `, vue.baseInfo && vue.baseInfo.type != 4 ?`\n        <div style="display:flex;padding-top:4px;"><div style="width:60px;text-align:left;"><div style="width:30px;font-size:12px;">实时位置</div></div><div style="flex:1"><span style="font-size:12px">${trackInfo.addressInfo}</span></div></div>\n      `:\'\',`\n      </div>\n      `].join(\'\');\n    },\n    moveToEnd(type){\n      const vue = this;\n      vue.focusedPoint = type;\n      const realtime = vue.trackInfo && vue.trackInfo.realtime.slice() || [];\n      switch(type) {\n      case "driver":\n        return mapUtils.tracking.getValidPathArray(vue, realtime.filter(ele => ele.origin == mapUtils.base.glossary.pointType.app)).then((paths) => {\n          if(paths.length) {\n            return mapUtils.tracking.moveLorryTo(vue, paths, vue.vehicleType, vue.emitLastPosition);\n          } else {\n            return mapUtils.tracking.hideInfoWindow(vue);\n          }\n        });\n      case "vehicle":\n        return mapUtils.tracking.getValidPathArray(vue, realtime.filter(ele => ele.origin != mapUtils.base.glossary.pointType.app)).then((paths) => {\n          if (paths.length) {\n            return mapUtils.tracking.moveLorryTo(vue, paths, vue.vehicleType, vue.emitLastPosition);            \n          } else {\n            return mapUtils.tracking.hideInfoWindow(vue);\n          }\n        });\n      };\n    }\n  }\n}\n<\/script>\n\n<style>\n.track-amap-container {\n  flex: 1;\n  width: 100%;\n  height: 100%;\n  background: coral;\n}\n.track-amap {\n  min-width: 200px;\n  min-height: 200px;\n  flex: 1;\n}\n.driver-info {\n  position: absolute;\n  top: 20px;\n  left: 20px;\n  padding:8px;\n  border-radius:4px;\n  background:#ffffffa0;\n  display:flex;\n  flex-direction: row;\n  align-items: center;\n}\n.track-tabs {\n  background: transparent;\n  position: absolute;\n  top: 120px;\n  left: 20px;\n}\n.user-avatar {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  margin-right: 10px;\n}\n.user-avatar img {\n  width: 100%;\n  height: 100%;\n  opacity: 0.95;\n}\n.user-info {\n  width: 180px;\n  height: 60px;\n  padding: 0 10px;\n  color:#000000a0;\n}\n.user-name {\n  margin-right: 10px;\n}\n.user-phone {\n  line-height: 30px;\n}\n.plate-code >span {\n  background-color: #FAECD880;\n  padding:0 4px;\n  color: #61503A;\n  border-radius: 2px;\n}\n.height-100p {\n  height: 100%;\n}\n.min-height-400 {\n  min-height: 400px;\n}\n.min-height-700 {\n  min-height: 700px;\n}\n.amap-logo,\n.amap-copyright {\n  display: none !important;\n}\n.track-playback {\n  color:#000000a0;\n  display: flex;\n  flex-direction:column;\n  padding: 0 10px;\n  align-items: center;\n  justify-content:space-between;\n}\n.track-playback .el-button + .el-button {\n  margin-left:0;\n}\n.el-button.trackbutton {\n  background-color: #ffffff80;\n  border-color: #409EFF40;\n  color:#409EFF;\n  border-radius: 6px;\n  padding-bottom:5px !important;\n  padding-top:5px !important;\n}\n.trackbutton > span {\n  font-size: 12px;\n  font-weight: 700;\n  background: transparent;\n}\n.el-button.trackbutton:hover {\n  background-color: #409EFF18;\n  border-color: #409EFF00;\n  box-shadow: unset;\n}\n\n.track-playing {\n  background: transparent;\n  position: absolute;\n  left: 20px;\n  bottom: 20px;\n}\n.track-control {\n  min-width:100px;\n  justify-content: space-evenly;\n}\n.track-control > span {\n  display:inline-block;\n  height:14px;\n  width:14px;\n  background-size:contain;\n  background-repeat:no-repeat;\n}\n</style>\n']},media:void 0})},__vue_scope_id__$6=void 0,__vue_module_identifier__$6=void 0,__vue_is_functional_template__$6=!1,__vue_component__$6=normalizeComponent({render:__vue_render__$6,staticRenderFns:__vue_staticRenderFns__$6},__vue_inject_styles__$6,__vue_script__$6,__vue_scope_id__$6,__vue_is_functional_template__$6,__vue_module_identifier__$6,!1,createInjector,void 0,void 0),tryBroadcastMessage=function(e,n){if(void 0===e&&(e={}),void 0===n&&(n="defaultDayiChannel"),window.BroadcastChannel){n=new window.BroadcastChannel(n);return n.postMessage(e),n}},tryListenBroadcastMessage=function(e,n){if(void 0===e&&(e="defaultDayiChannel"),void 0===n&&(n=function(){}),window.BroadcastChannel){e=new window.BroadcastChannel(e);return e.onmessage=n,e}},ChannelEnum={default:"defaultDayiChannel",driverAudit:"dayi-driver-audit",vehicleAudit:"dayi-vehicle-audit"};Object.freeze(ChannelEnum);var broadcast=Object.freeze({__proto__:null,tryBroadcastMessage:tryBroadcastMessage,tryListenBroadcastMessage:tryListenBroadcastMessage,ChannelEnum:ChannelEnum}),index=Object.freeze({__proto__:null,broadcast:broadcast}),dashWidth=4,script$7={name:"ImageClipper",props:{square:{type:Boolean,default:!1},url:String},data:function(){return{localUrl:null}},computed:{canvas:function(){return this.square?{width:1920,height:1920}:{width:1920,height:1280}}},mounted:function(){var t=this;t.imageCache={},t.oldUrl=t.url,t.localLoadImage(t.url),t.clipperBase={},t.clipperBase.ctx2d=t.$refs.canvas.getContext("2d"),t.$refs.imgurl.onload=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];t.updateCanvas()},t.$refs.canvas.onmousedown=function(e){var n=t.$refs.canvas,n={clientWidth:n.clientWidth,offsetLeft:0,clientHeight:n.clientHeight,offsetTop:0};t.clipperBase.start=e,t.clipperBase.end=e,t.clipperBase.rect=n,t.beginDrawRect()},t.$refs.canvas.onmousemove=function(e){t.clipperBase.start&&(t.clipperBase.end=e,t.drawRect())},t.$refs.canvas.onmouseup=function(e){if(t.clipperBase.leave)return t.clipperBase.start=void 0,t.clipperBase.end=void 0,t.clearRect();t.clipperBase.end=e,t.endDrawRect()},t.$refs.canvas.onmouseleave=function(e){return t.clipperBase.leave=!0,t.clearRect()},t.$refs.canvas.onmouseenter=function(e){t.clipperBase.leave=!1},t.offcanvas=document.createElement("canvas"),t.offcanvas.width=t.canvas.width,t.offcanvas.height=t.canvas.height},updated:function(){var e=this;e.offcanvas.width=e.canvas.width,e.offcanvas.height=e.canvas.height,e.oldUrl!=e.url&&(e.oldUrl=e.url,e.localLoadImage(e.url))},methods:{updateClipper:function(){},updateCanvas:function(){var e=this,n=e.clipperBase.ctx2d;e.offcanvas.ctx=e.offcanvas.getContext("2d"),e.offcanvas.ctx.beginPath(),e.offcanvas.ctx.drawImage(e.$refs.imgurl,0,0,e.canvas.width,e.canvas.height),e.offcanvas.ctx.save(),n.beginPath(),n.drawImage(e.offcanvas,0,0),n.save()},beginDrawRect:function(){var e=this.clipperBase.ctx2d;e.save(),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.drawImage(this.offcanvas,0,0)},drawRect:function(){var e=this,n=e.clipperBase.ctx2d;n.restore(),n.beginPath(),n.clearRect(0,0,e.canvas.width,e.canvas.height),n.drawImage(e.offcanvas,0,0),n.fillStyle="rgba(0, 0, 0, 0.2)",n.fillRect(0,0,e.canvas.width,e.canvas.height);var t=e.$refs.canvas.clientWidth||1,i=e.$refs.canvas.clientHeight||1,a=Math.round(e.clipperBase.start.layerX*e.canvas.width/t),r=Math.round(e.clipperBase.start.layerY*e.canvas.height/i),o=Math.round((e.clipperBase.end.layerX-e.clipperBase.start.layerX)*e.canvas.width/t),c=Math.round((e.clipperBase.end.layerY-e.clipperBase.start.layerY)*e.canvas.height/i),s=Math.min(a,a+o),t=Math.min(r,r+c),i=Math.abs(o),a=Math.abs(c);e.clipperBase.clip={startX:s,startY:t,drawX:i,drawY:a},n.setLineDash([5,15]),n.lineWidth=dashWidth,n.strokeStyle="blue",n.strokeRect(s-dashWidth,r-dashWidth,o+2*dashWidth,c+2*dashWidth),n.drawImage(e.offcanvas,s,t,i,a,s,t,i,a),n.closePath()},endDrawRect:function(){var e=this;if(e.clipperBase.clip){var n=e.clipperBase.clip,t=n.startX,i=n.startY,a=n.drawX,n=n.drawY;try{var r=e.offcanvas.ctx.getImageData(t,i,a,n);e.$emit("clipped",r)}catch(e){console.log("e",e)}e.clearRect()}},clearRect:function(){var e=this,n=e.clipperBase.ctx2d;e.clipperBase.start=void 0,e.clipperBase.end=void 0,e.clipperBase.clip=void 0,n.clearRect(0,0,e.canvas.width,e.canvas.height),n.drawImage(e.offcanvas,0,0)},localLoadImage:function(e){this.localUrl=e}}},__vue_script__$7=script$7,__vue_render__$7=function(){var e=this,n=e.$createElement,n=e._self._c||n;return n("div",{staticClass:"image-clipper",attrs:{square:e.square}},[n("img",{ref:"imgurl",staticClass:"image-clipper-item",attrs:{src:e.localUrl}}),e._v(" "),n("canvas",{ref:"canvas",staticClass:"image-clipper-item",attrs:{width:e.canvas.width,height:e.canvas.height}})])},__vue_staticRenderFns__$7=[];__vue_render__$7._withStripped=!0;var __vue_inject_styles__$7=function(e){e&&e("data-v-2bc2add6_0",{source:'\n[square="true"].image-clipper[data-v-2bc2add6] {\n  width:100%;\n  padding-bottom:100%;\n}\n.image-clipper[data-v-2bc2add6] {\n  width:100%;\n  position: relative;\n}\n.image-clipper > img[data-v-2bc2add6] {\n  visibility: hidden;\n}\n.image-clipper > .image-clipper-item[data-v-2bc2add6] {\n  position: absolute;\n  top:0;\n  left:0;\n  right:0;\n  bottom:0;\n  width:100%;\n  height: 100%;\n}\n\n',map:{version:3,sources:["/media/liuhanru/mywork/apps/dayi/admin-widget/src/widget/ImageClipper.vue"],names:[],mappings:";AAqMA;EACA,UAAA;EACA,mBAAA;AACA;AACA;EACA,UAAA;EACA,kBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,kBAAA;EACA,KAAA;EACA,MAAA;EACA,OAAA;EACA,QAAA;EACA,UAAA;EACA,YAAA;AACA",file:"ImageClipper.vue",sourcesContent:["<template>\n<div class=\"image-clipper\" :square=\"square\">\n  <img class=\"image-clipper-item\" ref=\"imgurl\" :src=\"localUrl\"/>\n  <canvas ref=\"canvas\" class=\"image-clipper-item\" :width=\"canvas.width\" :height=\"canvas.height\">\n  </canvas>\n</div>\n</template>\n\n<script>\n\nconst accumulateOffset = (ele, base=rect) => {\n  if(!ele) return base;\n  const {offsetLeft, offsetTop} = ele;\n  base.offsetLeft += offsetLeft;\n  base.offsetTop += offsetTop;\n  return accumulateOffset(ele.offsetParent, base);\n};\nconst dashWidth = 4;\nexport default {\n  name:\"ImageClipper\",\n  props:{\n    square:{type:Boolean, default:false},\n    url:String,\n  },\n  data() {\n    return {\n      localUrl:null,\n    };\n  },\n  computed: {\n    canvas() {\n      const vue = this;\n      if(vue.square) { \n        return { width:1920, height: 1920 };\n      }\n      return { width:1920, height:1280 };\n    },\n  },\n  mounted(){\n    const vue = this;\n    vue.imageCache = {};\n    vue.oldUrl = vue.url;\n    vue.localLoadImage(vue.url);\n    // console.log('mounted');\n    vue.clipperBase = {};\n    vue.clipperBase.ctx2d = vue.$refs.canvas.getContext('2d');\n    vue.$refs.imgurl.onload = (...args) => {\n      // console.log('image clipper', vue.url, args);\n      // URL.revokeObjectURL(vue.svgUrl);\n      vue.updateCanvas();\n    };\n    vue.$refs.canvas.onmousedown = (evt) => {\n      // console.log('onmousedown', evt, vue.$refs);\n      const {clientWidth, clientHeight } = vue.$refs.canvas;\n      const rect = {clientWidth, offsetLeft:0, clientHeight, offsetTop:0};\n      // accumulateOffset(vue.$refs.canvas, rect);\n      vue.clipperBase.start = evt;\n      vue.clipperBase.end = evt;\n      vue.clipperBase.rect = rect;\n      vue.beginDrawRect();\n    };\n    vue.$refs.canvas.onmousemove = (evt) => {\n      if(!vue.clipperBase.start) return void 0;\n      // console.log('onmousemove', evt);\n      vue.clipperBase.end = evt;\n      vue.drawRect();\n    };\n    vue.$refs.canvas.onmouseup = (evt) => {\n      // console.log('onmouseup', evt);\n      if(vue.clipperBase.leave) {\n        vue.clipperBase.start = undefined;\n        vue.clipperBase.end = undefined;\n        return vue.clearRect();\n      }\n      vue.clipperBase.end = evt;\n      vue.endDrawRect();\n    };\n    vue.$refs.canvas.onmouseleave = (evt) => {\n      //console.log('onmouseleave', evt);\n      vue.clipperBase.leave = true;\n      return vue.clearRect();\n    };\n    vue.$refs.canvas.onmouseenter = (evt) => {\n      //console.log('onmouseenter');\n      vue.clipperBase.leave = false;\n    };\n    vue.offcanvas = document.createElement('canvas');\n    vue.offcanvas.width = vue.canvas.width;\n    vue.offcanvas.height = vue.canvas.height;\n  },\n  updated(){\n    const vue = this;\n    // console.log('update');\n    vue.offcanvas.width = vue.canvas.width;\n    vue.offcanvas.height = vue.canvas.height;\n    if(vue.oldUrl != vue.url) {\n      vue.oldUrl = vue.url;\n      vue.localLoadImage(vue.url);\n    }\n  },\n  methods:{\n    updateClipper(){\n      const vue = this;\n    },\n    updateCanvas() {\n      const vue = this;\n      const ctx2d = vue.clipperBase.ctx2d;\n      vue.offcanvas.ctx = vue.offcanvas.getContext('2d');\n      vue.offcanvas.ctx.beginPath();\n      vue.offcanvas.ctx.drawImage(vue.$refs.imgurl, 0, 0, vue.canvas.width, vue.canvas.height);\n      vue.offcanvas.ctx.save();\n      ctx2d.beginPath();\n      ctx2d.drawImage(vue.offcanvas, 0, 0);\n      ctx2d.save();\n      // console.log('updateCanvas');\n    },\n    beginDrawRect(){\n      const vue = this;\n      const ctx2d = vue.clipperBase.ctx2d;\n      ctx2d.save();\n      ctx2d.clearRect(0,0, vue.canvas.width, vue.canvas.height);\n      ctx2d.drawImage(vue.offcanvas, 0, 0);\n      // ctx2d.fill();\n    },\n    drawRect(){\n      const vue = this;\n      const ctx2d = vue.clipperBase.ctx2d;\n      ctx2d.restore();\n      ctx2d.beginPath();\n      ctx2d.clearRect(0,0, vue.canvas.width, vue.canvas.height);\n      ctx2d.drawImage(vue.offcanvas, 0, 0);\n      ctx2d.fillStyle = 'rgba(0, 0, 0, 0.2)';\n      ctx2d.fillRect(0, 0, vue.canvas.width, vue.canvas.height);\n      const clientWidth = vue.$refs.canvas.clientWidth || 1;\n      const clientHeight = vue.$refs.canvas.clientHeight || 1;\n      const x = Math.round((vue.clipperBase.start.layerX) * vue.canvas.width / clientWidth);\n      const y = Math.round((vue.clipperBase.start.layerY) * vue.canvas.height/ clientHeight);\n      const wx = Math.round((vue.clipperBase.end.layerX - vue.clipperBase.start.layerX) * vue.canvas.width / clientWidth);\n      const wy = Math.round((vue.clipperBase.end.layerY - vue.clipperBase.start.layerY) * vue.canvas.height/ clientHeight);\n      const startX = Math.min(x, x+wx);\n      const startY = Math.min(y, y+wy);\n      const drawX = Math.abs(wx);\n      const drawY = Math.abs(wy);\n      vue.clipperBase.clip = {startX,startY, drawX, drawY};\n      ctx2d.setLineDash([5, 15]);\n      ctx2d.lineWidth = dashWidth;\n      ctx2d.strokeStyle = 'blue';\n      ctx2d.strokeRect(startX- dashWidth, y - dashWidth, wx + dashWidth*2, wy + dashWidth * 2);\n      ctx2d.drawImage(vue.offcanvas, startX, startY, drawX, drawY, startX, startY, drawX, drawY);\n      ctx2d.closePath();\n    },\n    endDrawRect(){\n      const vue = this;\n      // console.log('end draRect', vue.clipperBase);\n      if(!vue.clipperBase.clip) return;\n      const {startX,startY, drawX, drawY} = vue.clipperBase.clip;\n      try{\n        const imageData = vue.offcanvas.ctx.getImageData(startX, startY, drawX, drawY);\n        vue.$emit('clipped', imageData);\n      } catch (e) {\n        console.log('e', e);\n      }\n      vue.clearRect();\n    },\n    clearRect(){\n      const vue = this;\n      const ctx2d = vue.clipperBase.ctx2d;\n      vue.clipperBase.start = undefined;\n      vue.clipperBase.end = undefined;\n      vue.clipperBase.clip = undefined;\n      ctx2d.clearRect(0,0, vue.canvas.width, vue.canvas.height);\n      ctx2d.drawImage(vue.offcanvas, 0, 0);\n    },\n    localLoadImage(url) {\n      const vue = this;\n      vue.localUrl = url;\n      // if(vue.imageCache[url]) {\n      //  vue.localUrl = vue.imageCache[url];\n      //  return;\n      // }\n      // const xhr = new XMLHttpRequest();\n      // xhr.open('GET', url);\n      // xhr.onload = (resp)=>{\n      //   const buffer = resp.response;\n      //   const objUrl = URL.createObjeURL(new Blob(buffer, {type:'image/*'}));\n      //   vue.imageCache[url] = objUrl;\n      //   vue.localUrl = objUrl;\n      // };\n      // xhr.responseType = 'arraybuffer';\n      // xhr.send();\n    }\n  },\n}\n<\/script>\n\n<style scoped>\n\n[square=\"true\"].image-clipper {\n  width:100%;\n  padding-bottom:100%;\n}\n.image-clipper {\n  width:100%;\n  position: relative;\n}\n.image-clipper > img {\n  visibility: hidden;\n}\n.image-clipper > .image-clipper-item {\n  position: absolute;\n  top:0;\n  left:0;\n  right:0;\n  bottom:0;\n  width:100%;\n  height: 100%;\n}\n\n</style>\n"]},media:void 0})},__vue_scope_id__$7="data-v-2bc2add6",__vue_module_identifier__$7=void 0,__vue_is_functional_template__$7=!1,__vue_component__$7=normalizeComponent({render:__vue_render__$7,staticRenderFns:__vue_staticRenderFns__$7},__vue_inject_styles__$7,__vue_script__$7,__vue_scope_id__$7,__vue_is_functional_template__$7,__vue_module_identifier__$7,!1,createInjector,void 0,void 0),script$8={name:"RatioContainer",props:{ratio:{type:Number,default:.75}},data:function(){return{}},computed:{ratioStyle:function(){var e={};return e["padding-bottom"]=100*this.ratio+"%",e}}},__vue_script__$8=script$8,__vue_render__$8=function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticClass:"ratio-container",style:this.ratioStyle,attrs:{role:"ratio-container"}},[e("div",{staticClass:"realcontainer",attrs:{role:"realcontainer"}},[this._t("default")],2)])},__vue_staticRenderFns__$8=[];__vue_render__$8._withStripped=!0;var __vue_inject_styles__$8=function(e){e&&e("data-v-46712608_0",{source:'\n[role="ratio-contaienr"].ratio-container {\n  position:relative;\n  width:100%;\n}\n[role="ratio-contaienr"].ratio-container > [role="realcontainer"].realcontainer {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n',map:{version:3,sources:["/media/liuhanru/mywork/apps/dayi/admin-widget/src/widget/RatioContainer.vue"],names:[],mappings:";AA+BA;EACA,iBAAA;EACA,UAAA;AACA;AACA;EACA,kBAAA;EACA,OAAA;EACA,MAAA;EACA,QAAA;EACA,SAAA;AACA",file:"RatioContainer.vue",sourcesContent:['<template>\n<div role="ratio-container" class="ratio-container" :style="ratioStyle">\n  <div role="realcontainer" class="realcontainer">\n    <slot></slot>\n  </div>\n</div>\n</template>\n\n<script>\nexport default {\n  name:"RatioContainer",\n  props: {\n    ratio:{\n      type: Number, default: 0.75,\n    },\n  },\n  data() {\n    return {};\n  },\n  computed: {\n    ratioStyle() {\n      const vue = this;\n      return {\n        [\'padding-bottom\']: `${vue.ratio * 100}%`,\n      };\n    },\n  }\n}\n<\/script>\n\n<style>\n[role="ratio-contaienr"].ratio-container {\n  position:relative;\n  width:100%;\n}\n[role="ratio-contaienr"].ratio-container > [role="realcontainer"].realcontainer {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n</style>\n']},media:void 0})},__vue_scope_id__$8=void 0,__vue_module_identifier__$8=void 0,__vue_is_functional_template__$8=!1,__vue_component__$8=normalizeComponent({render:__vue_render__$8,staticRenderFns:__vue_staticRenderFns__$8},__vue_inject_styles__$8,__vue_script__$8,__vue_scope_id__$8,__vue_is_functional_template__$8,__vue_module_identifier__$8,!1,createInjector,void 0,void 0),calcLeftWidthPercent=function(e,n){var t=(n=void 0===n?{}:n).clientWidth,i=n.offsetLeft,n=(n.offsetTop,(e=void 0===e?{}:e).pageX-i),e=Math.max(10,.05*t),i=Math.max(t-10,.95*t);return 100*(n<e?e:i<n?i:n)/t},script$9={name:"WorkArea",data:function(){return{minWidth:""}},props:{showDirectory:Boolean,showContent:Boolean,sliding:Boolean,dragStart:Function,dragOver:Function,dragEnd:Function,leftBegin:{type:String,default:"auto"}},computed:{contentStyle:function(){return{minWidth:this.minWidth||this.leftBegin,maxWidth:this.minWidth||this.leftBegin}}},methods:{handleDragStart:function(e){var n=this;if(n.sliding){var t=uuid();return n.uuid=t,n.dragStart?n.dragStart(e,n.$refs.workarea):void 0}},handleDragOver:function(e){var n=this;if(n.sliding&&n.uuid)return n.dragOver?n.dragOver(e,n.$refs.workarea):void(n.minWidth=calcLeftWidthPercent(e,n.$refs.workarea)+"%")},handleDragEnd:function(e){var n=this;if(n.sliding&&n.uuid){if(n.uuid=null,n.dragEnd)return n.dragEnd(e,n.$refs.workarea);n.minWidth=calcLeftWidthPercent(e,n.$refs.workarea)+"%"}}}},__vue_script__$9=script$9,__vue_render__$9=function(){var e=this,n=e.$createElement,n=e._self._c||n;return n("div",{ref:"workarea",staticClass:"workarea"},[e.showDirectory?n("div",{staticClass:"workarea-left",style:e.contentStyle},[e._t("directory",[e._v("目录内容")])],2):e._e(),e._v(" "),n("div",{staticClass:"workarea-divider",attrs:{draggable:e.sliding},on:{dragstart:e.handleDragStart,dragover:e.handleDragOver,dragend:e.handleDragEnd}}),e._v(" "),e.showContent?n("div",{staticClass:"workarea-right"},[e._t("default")],2):e._e()])},__vue_staticRenderFns__$9=[];__vue_render__$9._withStripped=!0;var __vue_inject_styles__$9=function(e){e&&e("data-v-74f908f1_0",{source:'\n.workarea[data-v-74f908f1] {\n  display:flex;\n  flex-direction:row;\n  height:100%;\n  width: 100%;\n}\n.workarea-left[data-v-74f908f1] {\n  height:100%;\n  overflow-y:auto;\n}\n.workarea-divider[data-v-74f908f1] {\n  min-width:4px;\n  background-color:transparent;\n}\n[draggable="true"].workarea-divider[data-v-74f908f1]:hover,\n[draggable="true"].workarea-divider[data-v-74f908f1]:active{\n  filter:invert(0.5);\n  cursor:col-resize;\n  background-color:#fff;\n}\n.workarea-right[data-v-74f908f1] {\n  height:100%;\n  flex:1;\n  overflow-y:auto;\n}\n',map:{version:3,sources:["/media/liuhanru/mywork/apps/dayi/admin-widget/src/widget/WorkArea.vue"],names:[],mappings:";AAoFA;EACA,YAAA;EACA,kBAAA;EACA,WAAA;EACA,WAAA;AACA;AAEA;EACA,WAAA;EACA,eAAA;AACA;AAEA;EACA,aAAA;EACA,4BAAA;AACA;AAEA;;EAEA,kBAAA;EACA,iBAAA;EACA,qBAAA;AACA;AAEA;EACA,WAAA;EACA,MAAA;EACA,eAAA;AACA",file:"WorkArea.vue",sourcesContent:['<template>\n<div class="workarea" ref="workarea">\n  <div class="workarea-left" v-if="showDirectory" :style="contentStyle">\n    <slot name="directory">目录内容</slot>\n  </div>\n  <div class="workarea-divider" :draggable="sliding" @dragstart="handleDragStart" @dragover="handleDragOver" @dragend="handleDragEnd">\n  </div>\n  <div class="workarea-right" v-if="showContent">\n    <slot></slot>\n  </div>\n</div>\n</template>\n\n<script>\nimport * as simpleUUIdv4 from \'simple-uuidv4\';\nconst calcLeftWidthPercent = (evt={}, ele={}) => {\n  const {clientWidth, offsetLeft, offsetTop } = ele;\n  const {pageX} = evt;\n  // console.log(\'calc\',clientWidth, offsetLeft, offsetTop, rightLeft, evt);\n  const rightLeft = pageX - offsetLeft;\n  const minLeft = Math.max(10, clientWidth * 0.05);\n  const maxLeft = Math.max(clientWidth - 10,  clientWidth * 0.95);\n  const percent = rightLeft < minLeft ? minLeft : (rightLeft > maxLeft ? maxLeft : rightLeft);\n  return (percent * 100) / clientWidth;\n}\nexport default {\n  name:\'WorkArea\',\n  data(){\n    return {\n      minWidth:\'\',\n    };\n  },\n  props:{\n    showDirectory: Boolean,\n    showContent: Boolean,\n    sliding:Boolean,\n    dragStart:Function,\n    dragOver:Function,\n    dragEnd:Function,\n    leftBegin:{type:String, default:\'auto\'},\n  },\n  computed: {\n    contentStyle() {\n      const vue = this;\n      return {\n        minWidth: vue.minWidth || vue.leftBegin,\n        maxWidth: vue.minWidth || vue.leftBegin,\n      };\n    },\n  },\n  methods: {\n    handleDragStart(evt){\n      const vue = this;\n      if(!vue.sliding) return;\n      const uuid = simpleUUIdv4.uuid();\n      vue.uuid = uuid;\n      if(vue.dragStart) {\n        return vue.dragStart(evt, vue.$refs.workarea);\n      }\n      // const data = JSON.stringify(vue.start);\n      // console.log(\'handleDragStart\', evt, \'client properties\', clientWidth, offsetLeft, offsetTop, data);\n    },\n    handleDragOver(evt) {\n      const vue = this;\n      if(!vue.sliding || !vue.uuid) return;\n      if(vue.dragOver) {\n        return vue.dragOver(evt, vue.$refs.workarea);\n      }\n      vue.minWidth = calcLeftWidthPercent(evt, vue.$refs.workarea)+\'%\';\n    },\n    handleDragEnd(evt) {\n      const vue = this;\n      if(!vue.sliding || !vue.uuid) return;\n      vue.uuid = null;\n      if(vue.dragEnd) {\n        return vue.dragEnd(evt, vue.$refs.workarea);\n      }\n      vue.minWidth = calcLeftWidthPercent(evt, vue.$refs.workarea)+\'%\';\n    },\n  },\n}\n<\/script>\n\n<style scoped>\n.workarea {\n  display:flex;\n  flex-direction:row;\n  height:100%;\n  width: 100%;\n}\n\n.workarea-left {\n  height:100%;\n  overflow-y:auto;\n}\n\n.workarea-divider {\n  min-width:4px;\n  background-color:transparent;\n}\n\n[draggable="true"].workarea-divider:hover,\n[draggable="true"].workarea-divider:active{\n  filter:invert(0.5);\n  cursor:col-resize;\n  background-color:#fff;\n}\n\n.workarea-right {\n  height:100%;\n  flex:1;\n  overflow-y:auto;\n}\n</style>\n']},media:void 0})},__vue_scope_id__$9="data-v-74f908f1",__vue_module_identifier__$9=void 0,__vue_is_functional_template__$9=!1,__vue_component__$9=normalizeComponent({render:__vue_render__$9,staticRenderFns:__vue_staticRenderFns__$9},__vue_inject_styles__$9,__vue_script__$9,__vue_scope_id__$9,__vue_is_functional_template__$9,__vue_module_identifier__$9,!1,createInjector,void 0,void 0),index$1=Object.freeze({__proto__:null,ImageClipper:__vue_component__$7,RatioContainer:__vue_component__$8,WorkArea:__vue_component__$9});function install(e){install.installed||(install.installed=!0,e.component("AmapRoute",__vue_component__$1),e.component("WaybillTrack",__vue_component__$6))}var waybill={AmapRoute:__vue_component__$1,WaybillTrack:__vue_component__$6},plugin={install:install},GlobalVue=null;"undefined"!=typeof window?GlobalVue=window.Vue:"undefined"!=typeof global&&(GlobalVue=global.Vue),GlobalVue&&GlobalVue.use(plugin);export{index as base,install,map_utils as mapUtils,waybill,index$1 as widgets};
